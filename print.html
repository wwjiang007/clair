<!DOCTYPE HTML>
<html lang="en" class="light" dir="ltr">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Clair Documentation</title>
        <meta name="robots" content="noindex">


        <!-- Custom HTML head -->
        
        <meta name="description" content="Documentation for Clair.">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff">

        <link rel="icon" href="favicon.svg">
        <link rel="shortcut icon" href="favicon.png">
        <link rel="stylesheet" href="css/variables.css">
        <link rel="stylesheet" href="css/general.css">
        <link rel="stylesheet" href="css/chrome.css">
        <link rel="stylesheet" href="css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="highlight.css">
        <link rel="stylesheet" href="tomorrow-night.css">
        <link rel="stylesheet" href="ayu-highlight.css">

        <!-- Custom theme stylesheets -->

    </head>
    <body class="sidebar-visible no-js">
    <div id="body-container">
        <!-- Provide site root to javascript -->
        <script>
            var path_to_root = "";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "coal" : "light";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('light')
            html.classList.add(theme);
            var body = document.querySelector('body');
            body.classList.remove('no-js')
            body.classList.add('js');
        </script>

        <input type="checkbox" id="sidebar-toggle-anchor" class="hidden">

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            var body = document.querySelector('body');
            var sidebar = null;
            var sidebar_toggle = document.getElementById("sidebar-toggle-anchor");
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            } else {
                sidebar = 'hidden';
            }
            sidebar_toggle.checked = sidebar === 'visible';
            body.classList.remove('sidebar-visible');
            body.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item expanded "><a href="whatis.html"><strong aria-hidden="true">1.</strong> What is ClairV4</a></li><li class="chapter-item expanded "><a href="howto.html"><strong aria-hidden="true">2.</strong> How Tos</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="howto/getting_started.html"><strong aria-hidden="true">2.1.</strong> Getting Started With ClairV4</a></li><li class="chapter-item expanded "><a href="howto/deployment.html"><strong aria-hidden="true">2.2.</strong> Deployment Models</a></li><li class="chapter-item expanded "><a href="howto/api.html"><strong aria-hidden="true">2.3.</strong> API Definition</a></li><li class="chapter-item expanded "><a href="howto/testing.html"><strong aria-hidden="true">2.4.</strong> Testing ClairV4</a></li></ol></li><li class="chapter-item expanded "><a href="concepts.html"><strong aria-hidden="true">3.</strong> Concepts</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="concepts/indexing.html"><strong aria-hidden="true">3.1.</strong> Indexing</a></li><li class="chapter-item expanded "><a href="concepts/matching.html"><strong aria-hidden="true">3.2.</strong> Matching</a></li><li class="chapter-item expanded "><a href="concepts/api_internal.html"><strong aria-hidden="true">3.3.</strong> Internal API</a></li><li class="chapter-item expanded "><a href="concepts/authentication.html"><strong aria-hidden="true">3.4.</strong> Authentication</a></li><li class="chapter-item expanded "><a href="concepts/notifications.html"><strong aria-hidden="true">3.5.</strong> Notifications</a></li><li class="chapter-item expanded "><a href="concepts/updatersandairgap.html"><strong aria-hidden="true">3.6.</strong> Updaters and Airgap</a></li><li class="chapter-item expanded "><a href="concepts/operation.html"><strong aria-hidden="true">3.7.</strong> Operation</a></li></ol></li><li class="chapter-item expanded "><a href="contribution.html"><strong aria-hidden="true">4.</strong> Contribution</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="contribution/releases.html"><strong aria-hidden="true">4.1.</strong> Releases</a></li><li class="chapter-item expanded "><a href="contribution/commit_style.html"><strong aria-hidden="true">4.2.</strong> Commit Style</a></li></ol></li><li class="chapter-item expanded "><a href="reference.html"><strong aria-hidden="true">5.</strong> Reference</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="reference/api.html"><strong aria-hidden="true">5.1.</strong> Api</a></li><li class="chapter-item expanded "><a href="reference/clairctl.html"><strong aria-hidden="true">5.2.</strong> Clairctl</a></li><li class="chapter-item expanded "><a href="reference/config.html"><strong aria-hidden="true">5.3.</strong> Config</a></li><li class="chapter-item expanded "><a href="reference/indexer.html"><strong aria-hidden="true">5.4.</strong> Indexer</a></li><li class="chapter-item expanded "><a href="reference/matcher.html"><strong aria-hidden="true">5.5.</strong> Matcher</a></li><li class="chapter-item expanded "><a href="reference/notifier.html"><strong aria-hidden="true">5.6.</strong> Notifier</a></li><li class="chapter-item expanded "><a href="reference/metrics.html"><strong aria-hidden="true">5.7.</strong> Metrics</a></li></ol></li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle">
                <div class="sidebar-resize-indicator"></div>
            </div>
        </nav>

        <!-- Track and set sidebar scroll position -->
        <script>
            var sidebarScrollbox = document.querySelector('#sidebar .sidebar-scrollbox');
            sidebarScrollbox.addEventListener('click', function(e) {
                if (e.target.tagName === 'A') {
                    sessionStorage.setItem('sidebar-scroll', sidebarScrollbox.scrollTop);
                }
            }, { passive: true });
            var sidebarScrollTop = sessionStorage.getItem('sidebar-scroll');
            sessionStorage.removeItem('sidebar-scroll');
            if (sidebarScrollTop) {
                // preserve sidebar scroll position when navigating via links within sidebar
                sidebarScrollbox.scrollTop = sidebarScrollTop;
            } else {
                // scroll sidebar to current active section when navigating via "next/previous chapter" buttons
                var activeSection = document.querySelector('#sidebar .active');
                if (activeSection) {
                    activeSection.scrollIntoView({ block: 'center' });
                }
            }
        </script>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky">
                    <div class="left-buttons">
                        <label id="sidebar-toggle" class="icon-button" for="sidebar-toggle-anchor" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </label>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">Clair Documentation</h1>

                    <div class="right-buttons">
                        <a href="print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>
                        <a href="https://github.com/quay/clair" title="Git repository" aria-label="Git repository">
                            <i id="git-repository-button" class="fa fa-github"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="what-is-clair"><a class="header" href="#what-is-clair">What is Clair</a></h1>
<p>Clair is an application for parsing image contents and reporting vulnerabilities affecting the contents. This is done via static analysis and not at runtime.</p>
<p>Clair supports the extraction of contents and assignment of vulnerabilities from the following official base containers:</p>
<ul>
<li>Ubuntu</li>
<li>Debian</li>
<li>RHEL</li>
<li>Suse</li>
<li>Oracle</li>
<li>Alpine</li>
<li>AWS Linux</li>
<li>VMWare Photon</li>
<li>Python</li>
</ul>
<p>The above list defines Clair's current support matrix.</p>
<h2 id="architecture"><a class="header" href="#architecture">Architecture</a></h2>
<p>Clair v4 utilizes the <a href="https://quay.github.io/claircore/">ClairCore</a> library as its engine for examining contents and reporting vulnerabilities. At a high level you can consider Clair a service wrapper to the functionality provided in the ClairCore library.</p>
<p><img src="./clairv4_arch.png" alt="diagram of clairV4 highlevel architecture" /></p>
<p>The above diagram expresses the separation of concerns between Clair and the ClairCore library. Most development involving new distributions, vulnerability sources, and layer indexing will occur in ClairCore.</p>
<h2 id="how-clair-works"><a class="header" href="#how-clair-works">How Clair Works</a></h2>
<p>Clair's analysis is broken into three distinct parts.</p>
<h3 id="indexing"><a class="header" href="#indexing">Indexing</a></h3>
<p>Indexing starts with submitting a Manifest to Clair. On receipt, Clair will fetch layers, scan their contents, and return an intermediate representation called an IndexReport.</p>
<p>Manifests are Clair's representation of a container image. Clair leverages the fact that OCI Manifests and Layers are content-addressed to reduce duplicated work.</p>
<p>Once a Manifest is indexed, the IndexReport is persisted for later retrieval.</p>
<h3 id="matching"><a class="header" href="#matching">Matching</a></h3>
<p>Matching is taking an IndexReport and correlating vulnerabilities affecting the manifest the report represents.</p>
<p>Clair is continually ingesting new security data and a request to the matcher will always provide you with the most up to date vulnerability analysis of an IndexReport.</p>
<p><em>How we implement indexing and matching in detail is covered in <a href="https://quay.github.io/claircore/">ClairCore's</a> documentation.</em></p>
<h3 id="notifications"><a class="header" href="#notifications">Notifications</a></h3>
<p>Clair implements a notification service.</p>
<p>When new vulnerabilities are discovered, the notifier service will determine if these vulnerabilities affect any indexed Manifests. The notifier will then take action according to its configuration.</p>
<h3 id="getting-started"><a class="header" href="#getting-started">Getting Started</a></h3>
<p>At this point you'll probably want to check out <a href="./howto/getting_started.html">Getting Started With Clair</a>.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="how-tos"><a class="header" href="#how-tos">How Tos</a></h1>
<p>The following sections provide instructions on accomplish specific goals in Clair.</p>
<ul>
<li><a href="./howto/api.html">API Definition</a></li>
<li><a href="./howto/deployment.html">Deployment Models</a></li>
<li><a href="./howto/getting_started.html">Getting Started</a></li>
<li><a href="./howto/testing.html">Testing ClairV4</a></li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="getting-started-with-clair"><a class="header" href="#getting-started-with-clair">Getting Started With Clair</a></h1>
<h2 id="releases"><a class="header" href="#releases">Releases</a></h2>
<p>All of the source code needed to build clair is packaged as an archive and
attached to the release. Releases are tracked at the <a href="https://github.com/quay/clair/releases">github releases</a>.</p>
<p>The release artifacts also include the clairctl command line tool.</p>
<h2 id="official-containers"><a class="header" href="#official-containers">Official Containers</a></h2>
<p>Clair is officially packaged and released as a container at
<a href="https://quay.io/repository/projectquay/clair">quay.io/projectquay/clair</a>. The <code>latest</code> tag tracks the git development branch,
and version tags are built from the corresponding release.</p>
<h2 id="running-clair"><a class="header" href="#running-clair">Running Clair</a></h2>
<p>The easiest way to get Clair up and running for test purposes is to use our <a href="howto/./testing.html">local dev environment</a></p>
<p>If you're the hands on type who wants to get into the details however, continue reading.</p>
<h2 id="modes"><a class="header" href="#modes">Modes</a></h2>
<p>Clair can run in several modes. <a href="howto/../reference/indexer.html">Indexer</a>, <a href="howto/../reference/matcher.html">matcher</a>, <a href="howto/../reference/notifier.html">notifier</a> or combo mode. In combo mode, everything runs in a single OS process.</p>
<p>If you are just starting with Clair you will most likely want to start with combo mode and venture out to a distributed deployment once acquainted.</p>
<p>This how-to will demonstrate combo mode and introduce some further reading on a distributed deployment.</p>
<h2 id="postgres"><a class="header" href="#postgres">Postgres</a></h2>
<p>Clair uses PostgreSQL for its data persistence. Migrations are supported so you should only need to point Clair to a fresh database and have it do the setup for you.</p>
<p>We will assume you have setup a postgres database and it's reachable with the following connection string:
<code>host=clair-db port=5432 user=clair dbname=clair sslmode=disable</code>. Adjust for your environment accordingly.</p>
<h2 id="starting-clair-in-combo-mode"><a class="header" href="#starting-clair-in-combo-mode">Starting Clair In Combo Mode</a></h2>
<p>At this point, you should either have built Clair from source or have pulled the container. In either case, we will assume that the <code>clair-db</code> hostname will resolve to your postgres database.</p>
<p><em>You may need to configure <a href="https://docs.docker.com/network/">docker</a> or <a href="https://podman.io/getting-started/network.html">podman</a> networking if you are utilizing containers. This is out of scope for this how-to.</em></p>
<p>A basic config for combo mode can be found <a href="https://github.com/quay/clair/blob/main/config.yaml.sample">here</a>. Make sure to edit this config with your database settings and set "migrations" to <code>true</code> for all mode stanzas. In this basic combo mode, all "connstring" fields should point to the same database and any *_addr fields are simply ignored. For more details see the <a href="howto/../reference/config.html">config reference</a> and <a href="howto/./deployment.html">deployment models</a></p>
<p>Clair has 3 requirements to start:</p>
<ul>
<li>The <code>mode</code> flag or <code>CLAIR_MODE</code> environment variable specifying what mode this instance will run in.</li>
<li>The <code>conf</code> flag or <code>CLAIR_CONF</code> environment variable specifying where Clair can find its configuration.</li>
<li>A yaml document providing Clair's configuration.</li>
</ul>
<p>If you are running a container, you can <a href="https://docs.docker.com/storage/volumes/">mount</a> a Clair config and set the <code>CLAIR_CONF</code> environment variable to the corresponding path.</p>
<pre><code>CLAIR_MODE=combo
CLAIR_CONF=/path/to/mounted/config.yaml
</code></pre>
<p>If you are running a Clair binary directly, its likely easiest to use the command line.</p>
<pre><code>clair -conf "path/to/config.yaml" -mode "combo"
</code></pre>
<h2 id="submitting-a-manifest"><a class="header" href="#submitting-a-manifest">Submitting A Manifest</a></h2>
<p>The simplest way to submit a manifest to your running Clair is utilizing <a href="howto/../reference/clairctl.html">clairctl</a>. This is a CLI tool capable of grabbing image manifests from public repositories and submitting them for analysis.
The command will be in the Clair container, but can also be installed locally by running the following command:</p>
<pre><code>go install github.com/quay/clair/v4/cmd/clairctl@latest
</code></pre>
<p>You can submit a manifest to ClairV4 via the following command.</p>
<pre><code class="language-shell">$ clairctl report --host ${net_address_of_clair} ${image_tag}
</code></pre>
<p>You will need to add the <code>config</code> flag if you are using a PSK authentication (as in the <a href="howto/./testing.html">local dev environment</a> setup, for example).</p>
<pre><code class="language-shell">$ clairctl report --config local-dev/clair/config.yaml --host ${net_address_of_clair} ${image_tag}
</code></pre>
<p>By default, <code>clairctl</code> will look for Clair at <code>localhost:6060</code> or the environment variable <code>CLAIR_API</code>, and for a configuration at <code>config.yaml</code> or the environment variable <code>CLAIR_CONF</code>.</p>
<p>If everything is configured correctly, you should see some output like the following informing you of vulnerabilities affecting the supplied image.</p>
<pre><code class="language-shell">$ clairctl report ubuntu:focal
ubuntu:focal found bash        5.0-6ubuntu1.1         CVE-2019-18276
ubuntu:focal found libpcre3    2:8.39-12build1        CVE-2017-11164
ubuntu:focal found libpcre3    2:8.39-12build1        CVE-2019-20838
ubuntu:focal found libpcre3    2:8.39-12build1        CVE-2020-14155
ubuntu:focal found libsystemd0 245.4-4ubuntu3.2       CVE-2018-20839
ubuntu:focal found libsystemd0 245.4-4ubuntu3.2       CVE-2020-13776
ubuntu:focal found libtasn1-6  4.16.0-2               CVE-2018-1000654
ubuntu:focal found libudev1    245.4-4ubuntu3.2       CVE-2018-20839
ubuntu:focal found libudev1    245.4-4ubuntu3.2       CVE-2020-13776
ubuntu:focal found login       1:4.8.1-1ubuntu5.20.04 CVE-2013-4235
ubuntu:focal found login       1:4.8.1-1ubuntu5.20.04 CVE-2018-7169
ubuntu:focal found coreutils   8.30-3ubuntu2          CVE-2016-2781
ubuntu:focal found passwd      1:4.8.1-1ubuntu5.20.04 CVE-2013-4235
ubuntu:focal found passwd      1:4.8.1-1ubuntu5.20.04 CVE-2018-7169
ubuntu:focal found perl-base   5.30.0-9build1         CVE-2020-10543
ubuntu:focal found perl-base   5.30.0-9build1         CVE-2020-10878
ubuntu:focal found perl-base   5.30.0-9build1         CVE-2020-12723
ubuntu:focal found tar         1.30+dfsg-7            CVE-2019-9923
ubuntu:focal found dpkg        1.19.7ubuntu3          CVE-2017-8283
ubuntu:focal found gpgv        2.2.19-3ubuntu2        CVE-2019-13050
ubuntu:focal found libc-bin    2.31-0ubuntu9          CVE-2016-10228
ubuntu:focal found libc-bin    2.31-0ubuntu9          CVE-2020-6096
ubuntu:focal found libc6       2.31-0ubuntu9          CVE-2016-10228
ubuntu:focal found libc6       2.31-0ubuntu9          CVE-2020-6096
ubuntu:focal found libgcrypt20 1.8.5-5ubuntu1         CVE-2019-12904
</code></pre>
<p>To test locally-built images, you'll need to push them to a registry that is accessible by the Clair service and the <code>clairctl</code> command.
A local registry can be used for this, but the specifics of configuration vary by registry and container runtime.
Consult the relevant documentation for more information.</p>
<h2 id="whats-next"><a class="header" href="#whats-next">What's Next</a></h2>
<p>Now that you see the basic usage of Clair, you can checkout our <a href="howto/./deployment.html">deployment models</a> to learn different ways of deploying.</p>
<p>You may also be curious about how <code>clairctl</code> did that work. Check out our <a href="howto/./api.html">API definition</a> to understand how an application interacts with Clair.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="deploying-clair"><a class="header" href="#deploying-clair">Deploying Clair</a></h1>
<p>Clair v4 was designed with flexible deployment architectures in mind.
An operator is free to choose a deployment model which scales to their use cases.</p>
<h2 id="configuration"><a class="header" href="#configuration">Configuration</a></h2>
<p>Before jumping directly into the models, its important to note that Clair is designed to use a single configuration file across all node types.
This design decision makes it very easy to deploy on systems like Kubernetes and OpenShift.</p>
<p>See <a href="howto/../reference/config.html">Config Reference</a></p>
<h2 id="combined-deployment"><a class="header" href="#combined-deployment">Combined Deployment</a></h2>
<p>In a combined deployment, all the Clair processes run in a single OS process.
This is by far the easiest deployment model to configure as it involves the least moving parts.</p>
<p>A load balancer is still recommended if you plan on performing TLS termination.
Typically this will be a OpenShift route or a Kubernetes ingress.</p>
<p><img src="howto/./clairv4_combo_single_db.png" alt="combo mode single db deployment diagran" /></p>
<p>In the above diagram, Clair is running in combo mode and talking to a single database.
To configure this mode, you will provide all node types the same database and start Clair in <strong>combo</strong> mode.</p>
<pre><code>...
indexer:
    connstring: "host=clairdb user=pqgotest dbname=pqgotest sslmode=verify-full"
matcher:
    connstring: "host=clairdb user=pqgotest dbname=pqgotest sslmode=verify-full"
    ...
notifier:
    connstring: "host=clairdb user=pqgotest dbname=pqgotest sslmode=verify-full"
    ...
</code></pre>
<p>In this mode, any configuration informing Clair how to talk to other nodes is ignored;
it is not needed as all intra-process communication is done directly.</p>
<p>For added flexibility, it's also supported to split the databases while in combo mode.</p>
<p><img src="howto/./clairv4_combo_multi_db.png" alt="combo mode multiple db deployment diagran" /></p>
<p>In the above diagram, Clair is running in combo mode but database load is split between multiple databases.
Since Clair is conceptually a set of micro-services, its processes do not share database tables even when combined into the same OS process.</p>
<p>To configure this mode, you would provide each process its own "connstring" in the configuration.</p>
<pre><code>...
indexer:
    connstring: "host=indexer-clairdb user=pqgotest dbname=pqgotest sslmode=verify-full"
matcher:
    connstring: "host=matcher-clairdb user=pqgotest dbname=pqgotest sslmode=verify-full"
    ...
notifier:
    connstring: "host=notifier-clairdb user=pqgotest dbname=pqgotest sslmode=verify-full"
    ...
</code></pre>
<h2 id="distributed-deployment"><a class="header" href="#distributed-deployment">Distributed Deployment</a></h2>
<p>If your application needs to asymmetrically scale or you expect high load you may want to consider a distributed deployment.</p>
<p>In a distributed deployment, each Clair process runs in its own OS process.
Typically this will be a Kubernetes or OpenShift Pod.</p>
<p>A load balancer <strong>must</strong> be setup in this deployment model.
The load balancer will route traffic between Clair nodes along with routing API requests via <a href="https://devcentral.f5.com/s/articles/the-three-http-routing-patterns-you-should-know-30764">path based routing</a> to the correct services.
In a Kubernetes or OpenShift deployment this is usually handled with the <code>Service</code> and <code>Route</code> abstractions.
If deploying on bare metal, a load balancer will need to be configured appropriately.</p>
<p><img src="howto/./clairv4_distributed_multi_db.png" alt="distributed mode multiple db deployment diagran" /></p>
<p>In the above diagram, a load balancer is configured to route traffic coming from the client to the correct service.
This routing is path based and requires a layer 7 load balancer.
Traefik, Nginx, and HAProxy are all capable of this.
As mentioned above, this functionality is native to OpenShift and Kubernetes.</p>
<p>In this configuration, you'd supply each process with database connection strings and addresses for their dependent services.
Each OS process will need to have its "mode" CLI flag or environment variable set to the appropriate value.
See <a href="howto/../reference/config.html">Config Reference</a></p>
<pre><code>...
indexer:
    connstring: "host=indexer-clairdb user=pqgotest dbname=pqgotest sslmode=verify-full"
matcher:
    connstring: "host=matcher-clairdb user=pqgotest dbname=pqgotest sslmode=verify-full"
    indexer_addr: "indexer-service"
    ...
notifier:
    connstring: "host=notifier-clairdb user=pqgotest dbname=pqgotest sslmode=verify-full"
    indexer_addr: "indexer-service"
    matcher_addr: "matcher-service"
    ...
</code></pre>
<p>Keep in mind a config file per process is not need.
Processes only use the values necessary for their configured mode.</p>
<h2 id="tls-termination"><a class="header" href="#tls-termination">TLS Termination</a></h2>
<p>It's recommended to offload TLS termination to the load balancing infrastructure.
This design choice is due to the ubiquity of Kubernetes and OpenShift infrastructure already providing this facility.</p>
<p>If this is not possible for some reason, it is possible to have processes terminate TLS by using the <code>$.tls</code> configuration key.
A load balancer is still required.</p>
<h2 id="disk-usage-considerations"><a class="header" href="#disk-usage-considerations">Disk Usage Considerations</a></h2>
<p>By default, Clair will store container layers in <code>/var/tmp</code> while in use.
This can be changed by setting the <code>TMPDIR</code> environment variable.
There's currently no way to change this in the configuration file.</p>
<p>The disk space needed depends on the precise layers being indexed at any one time,
but a good approximation is twice as large as the largest (uncompressed size) layer in the corpus.</p>
<h2 id="more-on-path-routing"><a class="header" href="#more-on-path-routing">More On Path Routing</a></h2>
<p>If you are considering a distributed deployment you will need more details on <a href="https://devcentral.f5.com/s/articles/the-three-http-routing-patterns-you-should-know-30764">path based routing</a>.</p>
<p>Learn how to grab our OpenAPI spec <a href="howto/./api.html">here</a> and either start up a local dev instance of the swagger editor or load the spec file into the <a href="https://petstore.swagger.io/#/">online editor</a>.</p>
<p>You will notice particular API paths are grouped by the services which implement them.
This is your guide to configure your layer 7 load balancer correctly.</p>
<p>When the load balancer encounters a particular path prefix it must send those request to the correct set of Clair nodes.</p>
<p>For example, this is how we configure Traefik in our local development environment:</p>
<pre><code>- "traefik.enable=true"
- "traefik.http.routers.notifier.entrypoints=clair"
- "traefik.http.routers.notifier.rule=PathPrefix(`/notifier`)"
- "traefik.http.routers.notifier.service=notifier"
- "traefik.http.services.notifier.loadbalancer.server.port=6000"
</code></pre>
<p>This configuration is saying "take any paths prefixes of /notifier/ and send them to the notifier services on port 6000".</p>
<p>Every load balancer will have their own way to perform path routing.
Check the documentation for your infrastructure of choice.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="api-definition"><a class="header" href="#api-definition">API Definition</a></h1>
<p>Clair provides its API definition via an OpenAPI specification. You can view our OpenAPI spec <a href="https://raw.githubusercontent.com/quay/clair/main/openapi.yaml">here</a></p>
<p>The OpenAPI spec can be used in a variety of ways.</p>
<ul>
<li>Generating http clients for your application</li>
<li>Validating data returned from Clair</li>
<li>Importing into a rest client such as <a href="https://learning.postman.com/docs/integrations/available-integrations/working-with-openAPI/">Postman</a></li>
<li>API documentation via <a href="https://petstore.swagger.io/#/">Swagger Editor</a></li>
</ul>
<p>See <a href="howto/./testing.html">Testing Clair</a> to learn how the local dev tooling starts a local swagger editor. This is handy for making changes to the spec in real time.</p>
<p>See <a href="howto/../reference/api.html">API Reference</a> for a markdown rendered API reference.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="testing-clair"><a class="header" href="#testing-clair">Testing Clair</a></h1>
<p>We provide dev tooling in order to quickly get a fully configured Clair and Quay environment stood up locally.
This environment can be used to test and develop Clair's Quay integration.</p>
<h2 id="requirements"><a class="header" href="#requirements">Requirements</a></h2>
<h3 id="make"><a class="header" href="#make">Make</a></h3>
<p>Make is used to stand up the local dev environment.
Make is readily available in just about every package manager you can think of.
It's very likely your workstation already has make on it.</p>
<h3 id="podmandocker-and-docker-compose"><a class="header" href="#podmandocker-and-docker-compose">Podman/Docker and Docker Compose</a></h3>
<p>Currently our local dev tooling is supported by docker and docker-compose.
Podman should work fine since v3.0.</p>
<p>Docker version 19.03.11 and docker-compose version 1.28.6 are confirmed working.
Our assumption is most recent versions will not have an issue running the local dev tooling.</p>
<p>See <a href="https://podman.io/get-started">Get Started with Podman</a>.</p>
<h3 id="go-toolchain"><a class="header" href="#go-toolchain">Go Toolchain</a></h3>
<p>Go 1.20 or higher is required.</p>
<p>See <a href="https://golang.org/doc/install">Install Golang</a>.</p>
<h2 id="starting-a-cluster"><a class="header" href="#starting-a-cluster">Starting a cluster</a></h2>
<pre><code>git clone git@github.com:quay/clair.git
cd clair
docker-compose up -d
# or: make local-dev
# or: make local-dev-debug
# or: make local-dev-quay
</code></pre>
<p>After the local development environment successfully starts, the following infrastructure is available to you:</p>
<ul>
<li>
<p><code>localhost:8080</code></p>
<p>Dashboards and debugging services -- See the traefik configs in <code>local-dev/traefik</code> for where the various services are served.</p>
</li>
<li>
<p><code>localhost:6060</code></p>
<p>Clair services.</p>
</li>
<li>
<p>Quay (if started)</p>
<p>Quay will be started in a single node, local storage configuration.
A random port will be forwarded from localhost, see <code>podman port</code> for the mapping.</p>
</li>
<li>
<p>PostgreSQL</p>
<p>PostgreSQL will have a random port forwarded from localhost to the database server.
See <code>local-dev/clair/init.sql</code> for credentials and permissions and <code>podman port</code> for the mapping.</p>
</li>
</ul>
<h3 id="debugging"><a class="header" href="#debugging">Debugging</a></h3>
<p>With the <code>local-dev-debug</code> make target the operator has access to some more useful tools:</p>
<div class="table-wrapper"><table><thead><tr><th>Tool</th><th>Description</th><th>URL</th><th>Credentials</th></tr></thead><tbody>
<tr><td>pgAdmin</td><td>Postgres administration</td><td><a href="http://localhost:8080/pgadmin">localhost:8080/pgadmin</a></td><td>clair@clair.com:clair</td></tr>
<tr><td>jaeger</td><td>Distributed tracing</td><td><a href="http://localhost:8080/jaeger">localhost:8080/jaeger</a></td><td>-</td></tr>
<tr><td>prometheus</td><td>Metrics collection and querying</td><td><a href="http://localhost:8080/prom">localhost:8080/prom</a></td><td>-</td></tr>
<tr><td>pyroscope</td><td>Continuous profiling</td><td><a href="http://localhost:8080/pyroscope">localhost:8080/pyroscope</a></td><td>-</td></tr>
<tr><td>grafana</td><td>Metrics dashboards</td><td><a href="http://localhost:8080/grafana">localhost:8080/grafana</a></td><td>admin:admin</td></tr>
</tbody></table>
</div>
<h2 id="pushing-to-the-local-quay"><a class="header" href="#pushing-to-the-local-quay">Pushing to the Local Quay</a></h2>
<p>As mentioned above, Quay is forwarded to a random port on the host.
You can connect to the server on that port and create a account.
Creating an account named <code>admin</code> will ensure you are a super user.
An email is required, but is not validated.
You'll also need to create a namespace.</p>
<p>To push to Quay, you'll need to exec into the skopeo container:</p>
<pre><code class="language-shell">docker-compose exec -it skopeo /usr/bin/skopeo copy --dest-creds '&lt;user&gt;:&lt;pass&gt;' --dest-tls-verify=false &lt;src&gt; docker://clair-quay:8080/&lt;namespace&gt;/&lt;repo&gt;:&lt;tag&gt;
</code></pre>
<p>Note that skopeo expects its image arguments in <a href="https://github.com/containers/image/blob/main/docs/containers-transports.5.md"><code>containers-transports(5)</code></a> format.</p>
<h2 id="viewing-results"><a class="header" href="#viewing-results">Viewing Results</a></h2>
<p>By default, Quay displays security scanner results on the Tags page of the given repository.</p>
<h2 id="making-changes-to-configuration"><a class="header" href="#making-changes-to-configuration">Making changes to configuration</a></h2>
<p>You may want to play with either Clair or Quay's configuration.
If so, the configuration files can be found inside the repository at <code>local-dev/quay/config.yaml</code> and <code>local-dev/clair/config.yaml</code>.
Any changes to the configs will require a restart of the relevant service.
The quay-specific clair config is autogenerated, see the <code>Makefile</code>.</p>
<h2 id="tearing-it-down"><a class="header" href="#tearing-it-down">Tearing it down</a></h2>
<pre><code>docker-compose down
</code></pre>
<p>will rip the entire environment down.</p>
<h2 id="troubleshooting"><a class="header" href="#troubleshooting">Troubleshooting</a></h2>
<p>The most common issue encountered when standing up the dev environment is port conflicts.
Make sure that you do not have any other processes listening on any of the ports outlined above.</p>
<p>The second issue you may face is your Docker resource settings being too constrained to support the local dev stack.
This is typically seen on Docker4Mac since a VM is used with a specific set of resources configured.
See <a href="https://docs.docker.com/docker-for-mac/">Docker For Mac Manual</a> for instructions on how to change these resources.</p>
<p>If <code>docker-compose</code> reports errors like <code>Unsupported config option for services.activemq: 'profiles'</code>, the <code>docker-compose</code> version is too old and you'll need to upgrade.
Consult the relevant documentation for your environment for instructions.</p>
<p>Lastly, you can view traefik's ui at <a href="http://localhost:8080/dashboard/"><code>localhost:8080/dashboard/</code></a>.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="concepts"><a class="header" href="#concepts">Concepts</a></h1>
<p>The following sections give a conceptual overview of how Clair works internally.</p>
<ul>
<li><a href="./concepts/api_internal.html">Internal API</a></li>
<li><a href="./concepts/authentication.html">Authentication</a></li>
<li><a href="./concepts/notifications.html">Notifications</a></li>
<li><a href="./concepts/updatersandairgap.html">Updaters and Airgap</a></li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="indexing-1"><a class="header" href="#indexing-1">Indexing</a></h1>
<p>The <a href="concepts/../reference/indexer.html">Indexer</a> service is responsble for "indexing a manifest".</p>
<p>Indexing involves taking a manifest representing a container image and computing its constituent parts. The indexer is trying to discover what packages exist in the image, what distribution the image is derived from, and what package repositories are used within the image. Once this information is computed it is persisted in an IndexReport.</p>
<p>The IndexReport is an intermediate data structure describing the contents of a container image. This report can be fed to a <a href="concepts/../reference/matcher.html">Matcher</a> node for vulnerability analysis.</p>
<h2 id="content-addressability"><a class="header" href="#content-addressability">Content Addressability</a></h2>
<p>ClairV4 treats all manifests and layers as <a href="https://en.wikipedia.org/wiki/Content-addressable_storage">content addressable</a>. In the context of ClairV4 this means once we index a specific manifest we will not index it again unless it's required, and likewise with individual layers. This allows a large reduction in work.</p>
<p>For example, consider how many images in a registry may use "ubuntu:artful" as a base layer. It could be a large majority of images if the developers prefer basing their images off ubuntu. Treating the layers and manifests as content addressable means we will only fetch and scan the base layer once.</p>
<p>There are of course conditions where ClairV4 should re-index a manifest.</p>
<p>When an internal component such as a package scanner is updated, Clair will know to perform the scan with the new package scanner. Clair has enough information to determine that a component has changed and the IndexReport may be different this time around.</p>
<p>A client can track ClairV4's <code>index_state</code> endpoint to understand when an internal component has changed and subsequently issue re-indexes. See our <a href="concepts/../howto/api.html">api</a> guide to learn how to view our api specification.</p>
<h2 id="summary"><a class="header" href="#summary">Summary</a></h2>
<p>In summary, you should understand that Indexing is the process Clair uses to understand the contents of layers.</p>
<p>For a more indepth look at indexing check out the <a href="https://quay.github.io/claircore/">ClairCore Documentation</a></p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="matching-1"><a class="header" href="#matching-1">Matching</a></h1>
<p>A <a href="concepts/../reference/matcher.html">Matcher</a> node is responsible for matching vulnerabilities to a provided IndexReport.</p>
<p>Matchers by default are also responsible for keeping the database of vulnerabilities up to date. Matchers will typically run a set of Updaters which periodically probe their data sources for new contents, storing new vulnerabilities in the database when discovered.</p>
<p>The matcher API is designed to be called often and will always provide the most up-to-date VulnerabilityReport when queried. This VulnerabilityReport summaries both a manifest's contents and any vulnerabilities affecting the contents.</p>
<p>See our <a href="concepts/../howto/api.html">api</a> guide to learn how to view our api specification and work with the Matcher api.</p>
<h1 id="remote-matching"><a class="header" href="#remote-matching">Remote Matching</a></h1>
<p>A remote matcher behaves similarly to a matcher, except that it uses api calls to fetch vulnerability data for a provided IndexReport.
Remote matchers are useful when it is not possible to persist data from a given source into the database.</p>
<p>The <code>crda</code> remote matcher is responsible for fetching vulnerabilities from Red Hat Code Ready Dependency Analytics (CRDA).
By default, this matcher serves 100 requests per minute.
The rate-limiting can be lifted by requesting a dedicated API key, which is done via <a href="https://developers.redhat.com/content-gateway/link/3872178">this form</a>.</p>
<h2 id="summary-1"><a class="header" href="#summary-1">Summary</a></h2>
<p>In summary you should understand that a Matcher node provides vulnerability reports given the output of an Indexing process. By default it will also run background Updaters keeping the vulnerability database up-to-date.</p>
<p>For a more indepth look at indexing check out the <a href="https://quay.github.io/claircore/">ClairCore Documentation</a></p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="internal"><a class="header" href="#internal">Internal</a></h1>
<p>Internal endpoints are underneath <code>/api/v1/internal</code> and are meant for
communication between Clair microservices. If Clair is operating in combo mode,
these endpoints may not exist. Any sort of API ingress should disallow clients
to talk to these endpoints.</p>
<p>We do not formally expose these APIs in our OpenAPI spec.
Further information and usage is an effort left to the reader.</p>
<h2 id="updates-diffs"><a class="header" href="#updates-diffs">Updates Diffs</a></h2>
<p>The <code>update_diff/</code> endpoint exposes the api for diffing two update operations.
This is used by the notifier to determine the added and removed vulnerabilities on security databsae update.</p>
<h2 id="update-operation"><a class="header" href="#update-operation">Update Operation</a></h2>
<p>The <code>update_operation</code> endpoint exposes the api for viewing updaters' activity.
This is used by the notifier to determine if new updates have occurred and triggers an update diff to see what has changed.</p>
<h2 id="affectedmanifest"><a class="header" href="#affectedmanifest">AffectedManifest</a></h2>
<p>The <code>affected_manifest</code> endpoint exposes the api for retreiving affected manifests given a list of Vulnerabilities.
This is used by the notifier to determine the manifests that need to have a notification generated.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="authentication"><a class="header" href="#authentication">Authentication</a></h1>
<p>Previous versions of Clair used <a href="https://github.com/quay/jwtproxy">jwtproxy</a> to gate authentication. For ease of
building and deployment, v4 handles authentication itself.</p>
<p>Authentication is configured by specifying configuration objects underneath the
<code>auth</code> key of the configuration. Multiple authentication configurations may be
present, but they will be used preferentially in the order laid out below.</p>
<h3 id="psk"><a class="header" href="#psk">PSK</a></h3>
<p>Clair implements JWT-based authentication using a pre-shared key.</p>
<h4 id="configuration-1"><a class="header" href="#configuration-1">Configuration</a></h4>
<p>The <code>auth</code> stanza of the configuration file requires two parameters: <code>iss</code>, which
is the issuer to validate on all incoming requests; and <code>key</code>, which is a base64
encoded symmetric key for validating the requests.</p>
<pre><code class="language-yaml">auth:
  psk:
    key: &gt;-
      MDQ4ODBlNDAtNDc0ZC00MWUxLThhMzAtOTk0MzEwMGQwYTMxCg==
    iss: 'issuer'
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="notifications-1"><a class="header" href="#notifications-1">Notifications</a></h1>
<p>ClairV4 implements a notification system.</p>
<p>The notifier service will keep track of new security database updates and inform an interested client if new or removed vulnerabilities affect an indexed manifest.</p>
<p>The interested client can subscribe to notifications via several mechanisms:</p>
<ul>
<li>Webhook delivery</li>
<li>AMQP delivery</li>
<li>STOMP delivery</li>
</ul>
<p>Configuring the notifier is done via the yaml configuration.</p>
<p>See the "Notifier" object in our <a href="concepts/../reference/config.html">config reference</a></p>
<h2 id="a-notification"><a class="header" href="#a-notification">A Notification</a></h2>
<p>When the notifier becomes aware of new vulnerabilities affecting a previously indexed manifest, it will use the configured method(s) to issue notifications about the new changes. Any given notification expresses the <strong>most severe</strong> vulnerability discovered because of the change. This avoids creating a flurry of notifications for the same security database update.</p>
<p>Once a client receives a notification, it should issue a new request against the <a href="concepts/../reference/matcher.html">matcher</a> to receive an up-to-date vulnerability report.</p>
<p>The notification schema is the JSON marshaled form of the following types:</p>
<pre><code class="language-go">// Reason indicates the catalyst for a notification
type Reason string
const (
	Added   Reason = "added"
	Removed Reason = "removed"
	Changed Reason = "changed"
)
type Notification struct {
	ID            uuid.UUID        `json:"id"`
	Manifest      claircore.Digest `json:"manifest"`
	Reason        Reason           `json:"reason"`
	Vulnerability VulnSummary      `json:"vulnerability"`
}
type VulnSummary struct {
	Name           string                  `json:"name"`
	Description    string                  `json:"description"`
	Package        *claircore.Package      `json:"package,omitempty"`
	Distribution   *claircore.Distribution `json:"distribution,omitempty"`
	Repo           *claircore.Repository   `json:"repo,omitempty"`
	Severity       string                  `json:"severity"`
	FixedInVersion string                  `json:"fixed_in_version"`
	Links          string                  `json:"links"`
}
</code></pre>
<h2 id="webhook-delivery"><a class="header" href="#webhook-delivery">Webhook Delivery</a></h2>
<p><em>See the "Notifier.Webhook" object in the <a href="concepts/../reference/config.html">config reference</a> for complete configuration details.</em></p>
<p>When you configure notifier for webhook delivery you provide the service with the following pieces of information:</p>
<ul>
<li>A target URL where the webhook will fire</li>
<li>The callback URL where the notifier may be reached including its API path
<ul>
<li>e.g. "http://clair-notifier/notifier/api/v1/notification"</li>
</ul>
</li>
</ul>
<p>When the notifier has determined an updated security database has changed the affected status of an indexed manifest, it will deliver the following JSON body to the configured target:</p>
<pre><code class="language-json">{
  "notification_id": {uuid_string},
  "callback": {url_to_notifications}
}
</code></pre>
<p>On receipt, the server can immediately browse to the URL provided in the callback field.</p>
<h3 id="pagination"><a class="header" href="#pagination">Pagination</a></h3>
<p>The URL returned in the callback field brings the client to a paginated result.</p>
<p>The callback endpoint specification follows:</p>
<pre><code class="language-go">GET /notifier/api/v1/notification/{id}?[page_size=N][next=N]
{
  page: {
    size:    int,      // maximum number of notifications in the response
    next:   string, //  if present, the next id to fetch.
  }
  notifications: [ Notification… ] // array of notifications; max len == page.size
}
</code></pre>
<p>The GET callback request implements a simple bare-minimum paging mechanism.</p>
<p>The "page_size" url param controls how many notifications are returned in a single page.
If not provided a default of 500 is used.</p>
<p>The "next" url param informs Clair the next set of paged notifications to return. If not provided the 0th page is assumed.</p>
<p>A page object accompanying the notification list specifies "next" and "size" fields.</p>
<p>The "next" field returned in the page must be provided as the subsequent request's "next" url parameter to retrieve the next set of notifications.</p>
<p>The "size" field will simply echo back the request page_size parameter.</p>
<p>When the final page is served to the client the returned "page" data structure will not contain a "next" member.</p>
<p>Therefore the following loop is valid for obtaining all notifications for a notification id in pages of a specified size.</p>
<pre><code>{ page, notifications } = http.Get("http://clairv4/notifier/api/v1/notification/{id}?page_size=1000")

while (page.Next != None) {
    { page, notifications } = http.Get("http://clairv4/notifier/api/v1/notification/{id}?next={page.Next},page_size=1000")
}
</code></pre>
<p><em>Note: If the client specifies a custom page_size it must specify this page_size on every request for accurate responses.</em></p>
<h3 id="deleting-notifications"><a class="header" href="#deleting-notifications">Deleting Notifications</a></h3>
<p>While not mandatory, the client may issue a delete of the notification via a DELETE method. See <a href="concepts/../howto/api.html">api</a> to view the delete api.</p>
<p>Deleting a notification ID will clean up resources in the notifier quicker. Otherwise the notifier will wait a predetermined length of time before clearing delivered notifications from its database.</p>
<h2 id="amqp-delivery"><a class="header" href="#amqp-delivery">AMQP Delivery</a></h2>
<p><em>See the "Notifier.AMQP" object in our <a href="concepts/../reference/config.html">config reference</a> for complete configuration details.</em></p>
<p>The notifier also supports delivering to an AMQP broker. With AMQP delivery you can control whether a callback is delivered to the broker or whether notifications are directly delivered to the queue.</p>
<p>This allows the developer of the AMQP consumer to determine the logic of notification processing.</p>
<p>Note that AMQP delivery only supports AMQP 0.x protocol (e.g. RabbitMQ). If you need to publish notifications on AMQP 1.x message queue (e.g. ActiveMQ), you can use STOMP delivery.</p>
<h3 id="direct-delivery"><a class="header" href="#direct-delivery">Direct Delivery</a></h3>
<p>If the notifier's configuration specifies <code>direct: true</code> for AMQP, notifications will be delivered directly to the configured exchange.</p>
<p>When <code>direct</code> is set, the <code>rollup</code> property may be set to instruct the notifier to send a max number of notifications in a single AMQP message. This allows a balance between size of the message and number of messages delivered to the queue.</p>
<h2 id="testing-and-development"><a class="header" href="#testing-and-development">Testing and Development</a></h2>
<p>The notifier has a testing mode enabled when it sees the "NOTIFIER_TEST_MODE" environment variable set. It can be set to any value as we only check to see if it exists.</p>
<p>When this environment variable is set, the notifier will begin sending fake notifications to the configured delivery mechanism every "poll_interval" interval. This provides an easy way to implement and test new or existing deliverers.</p>
<p>The notifier will run in this mode until the environment variable is cleared and the service is restarted.</p>
<div style="break-before: page; page-break-before: always;"></div><h2 id="updaters"><a class="header" href="#updaters">Updaters</a></h2>
<p>Clair utilizes go packages we call "updaters" that encapsulate the logic of
fetching and parsing different vulnerability databases. Updaters are usually
pared with a matcher to interpret if and how any vulnerability is related to a
package.</p>
<p>Operators may wish to update the vulnerability database less frequently or not
import vulnerabilities from databases that they know will not be used.</p>
<h3 id="configuration-2"><a class="header" href="#configuration-2">Configuration</a></h3>
<p>Updaters can be configured by <code>updaters</code> key at the top of the configuration. If
updaters are being run automatically within the matcher processes, as is the
default, the period for running updaters is configured under the matcher's
configuration stanza.</p>
<h4 id="choosing-sets"><a class="header" href="#choosing-sets">Choosing Sets</a></h4>
<p>Specific sets of updaters can be selected by the <code>sets</code> list. If not present,
the defaults of all upstream updaters will be used.</p>
<pre><code class="language-yaml">updaters:
  sets:
    - rhel
</code></pre>
<h4 id="specific-updaters"><a class="header" href="#specific-updaters">Specific Updaters</a></h4>
<p>Configuration for specific updaters can be passed by putting a key underneath
the <code>config</code> member of the <code>updaters</code> object. The name of an updater may be
constructed dynamically; users should examine logs to double-check names.
The specific object that an updater expects should be covered in the updater's
documentation.</p>
<p>For example, to have the "rhel" updater fetch a manifest from a different
location:</p>
<pre><code class="language-yaml">updaters:
  config:
    rhel:
      url: https://example.com/mirror/oval/PULP_MANIFEST
</code></pre>
<h3 id="airgap"><a class="header" href="#airgap">Airgap</a></h3>
<p>For additional flexibility, Clair supports running updaters in a different
environment and importing the results. This is aimed at supporting installations
that disallow the Clair cluster from talking to the Internet directly. An update
procedure needs to arrange to call the relevant <code>clairctl</code> command in an
environment with access to the Internet, move the resulting artifact across the
airgap according to site policy, and then call the relevant <code>clairctl</code> command
to import the updates.</p>
<p>For example:</p>
<pre><code class="language-sh"># On a workstation, run:
clairctl export-updaters updates.json.gz
</code></pre>
<pre><code class="language-sh"># Move the resulting file to a place reachable by the cluster:
scp updates.json.gz internal-webserver:/var/www/
</code></pre>
<pre><code class="language-sh"># On a pod inside the cluster, import the file:
clairctl import-updaters http://web.svc/updates.json.gz
</code></pre>
<p>Note that a configuration file is needed to run these commands.</p>
<h4 id="configuration-3"><a class="header" href="#configuration-3">Configuration</a></h4>
<p>Matcher processes should have the <code>disable_updaters</code> key set to disable
automatic updaters running.</p>
<pre><code class="language-yaml">matcher:
  disable_updaters: true
</code></pre>
<h2 id="indexers"><a class="header" href="#indexers">Indexers</a></h2>
<h3 id="configuration-4"><a class="header" href="#configuration-4">Configuration</a></h3>
<h4 id="airgap-1"><a class="header" href="#airgap-1">Airgap</a></h4>
<pre><code class="language-yaml">indexer:
  airgap: true
</code></pre>
<h4 id="specific-scanners"><a class="header" href="#specific-scanners">Specific Scanners</a></h4>
<pre><code class="language-yaml">indexer:
  scanner:
    package:
      name:
        key: value
    repo:
      name:
        key: value
    dist:
      name:
        key: value
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="operation"><a class="header" href="#operation">Operation</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="contribuion"><a class="header" href="#contribuion">Contribuion</a></h1>
<p>The following sections provides information on how to contribute to Clair.</p>
<ul>
<li><a href="./contribution/commit_style.html">Commit Style</a></li>
<li><a href="./contribution/releases.html">Releases</a></li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="releases-1"><a class="header" href="#releases-1">Releases</a></h1>
<p>Clair releases are cut roughly every three months and actively maintained for
six.</p>
<p>This means that bugfixes should be landed on <code>master</code> (if applicable) and then
marked for backporting to a minor version's release branch. The process for
doing this is not yet formalized.</p>
<h2 id="process"><a class="header" href="#process">Process</a></h2>
<h3 id="minor"><a class="header" href="#minor">Minor</a></h3>
<p>When cutting a new minor release, two things need to be done: creating a tag and
creating a release branch. This can be done like so:</p>
<pre><code class="language-sh">git tag -as v4.x.0 HEAD
git push upstream HEAD:release-4.x tag v4.x.0
</code></pre>
<p>Then, a "release" needs to be created in the Github UI using the created tag.</p>
<h3 id="patch"><a class="header" href="#patch">Patch</a></h3>
<p>A patch release is just like a minor release with the caveat that minor version
tags should <em>only</em> appear on release branches and a new branch does not need to
be created.</p>
<pre><code class="language-sh">git checkout release-4.x
git tag -as v4.x.1 HEAD
git push upstream tag v4.x.1
</code></pre>
<p>Then, a "release" needs to be created in the Github UI using the created tag.</p>
<h3 id="creating-artifacts"><a class="header" href="#creating-artifacts">Creating Artifacts</a></h3>
<p>Clair's artifact release process is automated and driven off the releases in
Github.</p>
<p>Publishing a new release in the Github UI automatically triggers the creation of
a complete source archive and a container. The archive is attached to the
release, and the container is pushed to the
<a href="https://quay.io/repository/projectquay/clair"><code>quay.io/projectquay/clair</code></a>
repository.</p>
<p>This is all powered by a Github Action in <code>.github/workflows/cut-release.yml</code>.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="commit-style"><a class="header" href="#commit-style">Commit Style</a></h1>
<p>The Clair project utilizes well structured commits to keep the history useful and help with release automation.
We suggest signing off on your commits as well.</p>
<p>A typical commit will take on the following structure:</p>
<pre><code>&lt;scope&gt;: &lt;subject&gt;

&lt;body&gt;
Fixes #1
Pull Request #2

Signed-Off By: &lt;email&gt;
</code></pre>
<p>The header of the commit is regexp checked before commit and your commit will be kicked back if it does not conform.</p>
<h2 id="scope"><a class="header" href="#scope">Scope</a></h2>
<p>This is the section of code this commit influences.</p>
<p>You will often see scopes such as "notifier", "auth", "chore", "cicd".</p>
<p>We use this field to group commits by scope in our automated changelog generation.</p>
<p>It would be wise to take a look at our changelog before contributing to get an idea of the common scopes we use.</p>
<h2 id="subject"><a class="header" href="#subject">Subject</a></h2>
<p>Subject is a short and concise summary of the change the commit is introducing. It should be a sentence fragment without starting capitalization and ending punctuation and limited to about 60 characters, to allow for the scope prefix and decoration in the git log.</p>
<h2 id="body"><a class="header" href="#body">Body</a></h2>
<p>Body should be full of detail.</p>
<p>Explain what this commit is doing and why it is necessary.</p>
<p>You may include references to issues and pull requests as well. Our automated changelog process will discover references prefixed with "Fixes", "Closed" and "Pull Request"</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="reference"><a class="header" href="#reference">Reference</a></h1>
<p>The following sections provide reference information useful when exploring the documentation or working with Clair directly.</p>
<ul>
<li><a href="./reference/api.html">API</a></li>
<li><a href="./reference/clairctl.html">Clairctl</a></li>
<li><a href="./reference/config.html">Config</a></li>
<li><a href="./reference/indexer.html">Indexer</a></li>
<li><a href="./reference/matcher.html">Matcher</a></li>
<li><a href="./reference/notifier.html">Notifier</a></li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><hr />
<p>title: ClairV4 v1.1
language_tabs:</p>
<ul>
<li>python: Python</li>
<li>go: Golang</li>
<li>javascript: Javascript
language_clients:</li>
<li>python: ""</li>
<li>go: ""</li>
<li>javascript: ""
toc_footers: []
includes: []
search: false
highlight_theme: darkula
headingLevel: 2</li>
</ul>
<hr />
<!-- Generator: Widdershins v4.0.1 -->
<h1 id="clairv4"><a class="header" href="#clairv4">ClairV4 v1.1</a></h1>
<blockquote>
<p>Scroll down for code samples, example requests and responses. Select a language for code samples from the tabs above or the mobile navigation menu.</p>
</blockquote>
<p>ClairV4 is a set of cooperating microservices which scan, index, and match your container's content with known vulnerabilities.</p>
<p>Email: <a href="mailto:quay-devel@redhat.com">Clair Team</a> Web: <a href="http://github.com/quay/clair">Clair Team</a>
License: <a href="http://www.apache.org/licenses/">Apache License 2.0</a></p>
<h1 id="clairv4-notifier"><a class="header" href="#clairv4-notifier">Notifier</a></h1>
<h2 id="deletenotification"><a class="header" href="#deletenotification">DeleteNotification</a></h2>
<p><a id="opIdDeleteNotification"></a></p>
<blockquote>
<p>Code samples</p>
</blockquote>
<pre><code class="language-python">import requests
headers = {
  'Accept': 'application/json'
}

r = requests.delete('/notifier/api/v1/notification/{notification_id}', headers = headers)

print(r.json())

</code></pre>
<pre><code class="language-go">package main

import (
       "bytes"
       "net/http"
)

func main() {

    headers := map[string][]string{
        "Accept": []string{"application/json"},
    }

    data := bytes.NewBuffer([]byte{jsonReq})
    req, err := http.NewRequest("DELETE", "/notifier/api/v1/notification/{notification_id}", data)
    req.Header = headers

    client := &amp;http.Client{}
    resp, err := client.Do(req)
    // ...
}

</code></pre>
<pre><code class="language-javascript">
const headers = {
  'Accept':'application/json'
};

fetch('/notifier/api/v1/notification/{notification_id}',
{
  method: 'DELETE',

  headers: headers
})
.then(function(res) {
    return res.json();
}).then(function(body) {
    console.log(body);
});

</code></pre>
<p><code>DELETE /notifier/api/v1/notification/{notification_id}</code></p>
<p>Issues a delete of the provided notification id and all associated notifications. After this delete clients will no longer be able to retrieve notifications.</p>
<h3 id="deletenotification-parameters"><a class="header" href="#deletenotification-parameters">Parameters</a></h3>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>In</th><th>Type</th><th>Required</th><th>Description</th></tr></thead><tbody>
<tr><td>notification_id</td><td>path</td><td>string</td><td>false</td><td>A notification ID returned by a callback</td></tr>
</tbody></table>
</div>
<blockquote>
<p>Example responses</p>
</blockquote>
<blockquote>
<p>400 Response</p>
</blockquote>
<pre><code class="language-json">{
  "code": "string",
  "message": "string"
}
</code></pre>
<h3 id="deletenotification-responses"><a class="header" href="#deletenotification-responses">Responses</a></h3>
<div class="table-wrapper"><table><thead><tr><th>Status</th><th>Meaning</th><th>Description</th><th>Schema</th></tr></thead><tbody>
<tr><td>200</td><td><a href="https://tools.ietf.org/html/rfc7231#section-6.3.1">OK</a></td><td>OK</td><td>None</td></tr>
<tr><td>400</td><td><a href="https://tools.ietf.org/html/rfc7231#section-6.5.1">Bad Request</a></td><td>Bad Request</td><td><a href="reference/api.html#schemaerror">Error</a></td></tr>
<tr><td>405</td><td><a href="https://tools.ietf.org/html/rfc7231#section-6.5.5">Method Not Allowed</a></td><td>Method Not Allowed</td><td><a href="reference/api.html#schemaerror">Error</a></td></tr>
<tr><td>500</td><td><a href="https://tools.ietf.org/html/rfc7231#section-6.6.1">Internal Server Error</a></td><td>Internal Server Error</td><td><a href="reference/api.html#schemaerror">Error</a></td></tr>
</tbody></table>
</div><aside class="success">
This operation does not require authentication
</aside>
<h2 id="retrieve-a-paginated-result-of-notifications-for-the-provided-id"><a class="header" href="#retrieve-a-paginated-result-of-notifications-for-the-provided-id">Retrieve a paginated result of notifications for the provided id.</a></h2>
<p><a id="opIdGetNotification"></a></p>
<blockquote>
<p>Code samples</p>
</blockquote>
<pre><code class="language-python">import requests
headers = {
  'Accept': 'application/json'
}

r = requests.get('/notifier/api/v1/notification/{notification_id}', headers = headers)

print(r.json())

</code></pre>
<pre><code class="language-go">package main

import (
       "bytes"
       "net/http"
)

func main() {

    headers := map[string][]string{
        "Accept": []string{"application/json"},
    }

    data := bytes.NewBuffer([]byte{jsonReq})
    req, err := http.NewRequest("GET", "/notifier/api/v1/notification/{notification_id}", data)
    req.Header = headers

    client := &amp;http.Client{}
    resp, err := client.Do(req)
    // ...
}

</code></pre>
<pre><code class="language-javascript">
const headers = {
  'Accept':'application/json'
};

fetch('/notifier/api/v1/notification/{notification_id}',
{
  method: 'GET',

  headers: headers
})
.then(function(res) {
    return res.json();
}).then(function(body) {
    console.log(body);
});

</code></pre>
<p><code>GET /notifier/api/v1/notification/{notification_id}</code></p>
<p>By performing a GET with a notification_id as a path parameter, the client will retrieve a paginated response of notification objects.</p>
<h3 id="retrieve-a-paginated-result-of-notifications-for-the-provided-id.-parameters"><a class="header" href="#retrieve-a-paginated-result-of-notifications-for-the-provided-id.-parameters">Parameters</a></h3>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>In</th><th>Type</th><th>Required</th><th>Description</th></tr></thead><tbody>
<tr><td>notification_id</td><td>path</td><td>string</td><td>false</td><td>A notification ID returned by a callback</td></tr>
<tr><td>page_size</td><td>query</td><td>int</td><td>false</td><td>The maximum number of notifications to deliver in a single page.</td></tr>
<tr><td>next</td><td>query</td><td>string</td><td>false</td><td>The next page to fetch via id. Typically this number is provided on initial response in the page.next field. The first GET request may omit this field.</td></tr>
</tbody></table>
</div>
<blockquote>
<p>Example responses</p>
</blockquote>
<blockquote>
<p>200 Response</p>
</blockquote>
<pre><code class="language-json">{
  "page": {
    "size": 100,
    "next": "1b4d0db2-e757-4150-bbbb-543658144205"
  },
  "notifications": [
    {
      "id": "5e4b387e-88d3-4364-86fd-063447a6fad2",
      "manifest": "sha256:35c102085707f703de2d9eaad8752d6fe1b8f02b5d2149f1d8357c9cc7fb7d0a",
      "reason": "added",
      "vulnerability": {
        "name": "CVE-2009-5155",
        "fixed_in_version": "v0.0.1",
        "links": "http://link-to-advisory",
        "description": "In the GNU C Library (aka glibc or libc6) before 2.28, parse_reg_exp in posix/regcomp.c misparses alternatives, which allows attackers to cause a denial of service (assertion failure and application exit) or trigger an incorrect result by attempting a regular-expression match.\"",
        "normalized_severity": "Unknown",
        "package": {
          "id": "10",
          "name": "libapt-pkg5.0",
          "version": "1.6.11",
          "kind": "binary",
          "normalized_version": "",
          "arch": "x86",
          "module": "",
          "cpe": "",
          "source": {
            "id": "9",
            "name": "apt",
            "version": "1.6.11",
            "kind": "source",
            "source": null
          }
        },
        "distribution": {
          "id": "1",
          "did": "ubuntu",
          "name": "Ubuntu",
          "version": "18.04.3 LTS (Bionic Beaver)",
          "version_code_name": "bionic",
          "version_id": "18.04",
          "arch": "",
          "cpe": "",
          "pretty_name": "Ubuntu 18.04.3 LTS"
        },
        "repository": {
          "id": "string",
          "name": "string",
          "key": "string",
          "uri": "string",
          "cpe": "string"
        }
      }
    }
  ]
}
</code></pre>
<h3 id="retrieve-a-paginated-result-of-notifications-for-the-provided-id.-responses"><a class="header" href="#retrieve-a-paginated-result-of-notifications-for-the-provided-id.-responses">Responses</a></h3>
<div class="table-wrapper"><table><thead><tr><th>Status</th><th>Meaning</th><th>Description</th><th>Schema</th></tr></thead><tbody>
<tr><td>200</td><td><a href="https://tools.ietf.org/html/rfc7231#section-6.3.1">OK</a></td><td>A paginated list of notifications</td><td><a href="reference/api.html#schemapagednotifications">PagedNotifications</a></td></tr>
<tr><td>400</td><td><a href="https://tools.ietf.org/html/rfc7231#section-6.5.1">Bad Request</a></td><td>Bad Request</td><td><a href="reference/api.html#schemaerror">Error</a></td></tr>
<tr><td>405</td><td><a href="https://tools.ietf.org/html/rfc7231#section-6.5.5">Method Not Allowed</a></td><td>Method Not Allowed</td><td><a href="reference/api.html#schemaerror">Error</a></td></tr>
<tr><td>500</td><td><a href="https://tools.ietf.org/html/rfc7231#section-6.6.1">Internal Server Error</a></td><td>Internal Server Error</td><td><a href="reference/api.html#schemaerror">Error</a></td></tr>
</tbody></table>
</div><aside class="success">
This operation does not require authentication
</aside>
<h1 id="clairv4-indexer"><a class="header" href="#clairv4-indexer">Indexer</a></h1>
<h2 id="index-the-contents-of-a-manifest"><a class="header" href="#index-the-contents-of-a-manifest">Index the contents of a Manifest</a></h2>
<p><a id="opIdIndex"></a></p>
<blockquote>
<p>Code samples</p>
</blockquote>
<pre><code class="language-python">import requests
headers = {
  'Content-Type': 'application/json',
  'Accept': 'application/json'
}

r = requests.post('/indexer/api/v1/index_report', headers = headers)

print(r.json())

</code></pre>
<pre><code class="language-go">package main

import (
       "bytes"
       "net/http"
)

func main() {

    headers := map[string][]string{
        "Content-Type": []string{"application/json"},
        "Accept": []string{"application/json"},
    }

    data := bytes.NewBuffer([]byte{jsonReq})
    req, err := http.NewRequest("POST", "/indexer/api/v1/index_report", data)
    req.Header = headers

    client := &amp;http.Client{}
    resp, err := client.Do(req)
    // ...
}

</code></pre>
<pre><code class="language-javascript">const inputBody = '{
  "hash": "sha256:fc84b5febd328eccaa913807716887b3eb5ed08bc22cc6933a9ebf82766725e3",
  "layers": [
    {
      "hash": "sha256:fc84b5febd328eccaa913807716887b3eb5ed08bc22cc6933a9ebf82766725e3",
      "uri": "https://storage.example.com/blob/2f077db56abccc19f16f140f629ae98e904b4b7d563957a7fc319bd11b82ba36",
      "headers": {
        "property1": [
          "string"
        ],
        "property2": [
          "string"
        ]
      }
    }
  ]
}';
const headers = {
  'Content-Type':'application/json',
  'Accept':'application/json'
};

fetch('/indexer/api/v1/index_report',
{
  method: 'POST',
  body: inputBody,
  headers: headers
})
.then(function(res) {
    return res.json();
}).then(function(body) {
    console.log(body);
});

</code></pre>
<p><code>POST /indexer/api/v1/index_report</code></p>
<p>By submitting a Manifest object to this endpoint Clair will fetch the layers, scan each layer's contents, and provide an index of discovered packages, repository and distribution information.</p>
<blockquote>
<p>Body parameter</p>
</blockquote>
<pre><code class="language-json">{
  "hash": "sha256:fc84b5febd328eccaa913807716887b3eb5ed08bc22cc6933a9ebf82766725e3",
  "layers": [
    {
      "hash": "sha256:fc84b5febd328eccaa913807716887b3eb5ed08bc22cc6933a9ebf82766725e3",
      "uri": "https://storage.example.com/blob/2f077db56abccc19f16f140f629ae98e904b4b7d563957a7fc319bd11b82ba36",
      "headers": {
        "property1": [
          "string"
        ],
        "property2": [
          "string"
        ]
      }
    }
  ]
}
</code></pre>
<h3 id="index-the-contents-of-a-manifest-parameters"><a class="header" href="#index-the-contents-of-a-manifest-parameters">Parameters</a></h3>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>In</th><th>Type</th><th>Required</th><th>Description</th></tr></thead><tbody>
<tr><td>body</td><td>body</td><td><a href="reference/api.html#schemamanifest">Manifest</a></td><td>true</td><td>none</td></tr>
</tbody></table>
</div>
<blockquote>
<p>Example responses</p>
</blockquote>
<blockquote>
<p>201 Response</p>
</blockquote>
<pre><code class="language-json">{
  "manifest_hash": "sha256:fc84b5febd328eccaa913807716887b3eb5ed08bc22cc6933a9ebf82766725e3",
  "state": "IndexFinished",
  "packages": {
    "10": {
      "id": "10",
      "name": "libapt-pkg5.0",
      "version": "1.6.11",
      "kind": "binary",
      "normalized_version": "",
      "arch": "x86",
      "module": "",
      "cpe": "",
      "source": {
        "id": "9",
        "name": "apt",
        "version": "1.6.11",
        "kind": "source",
        "source": null
      }
    }
  },
  "distributions": {
    "1": {
      "id": "1",
      "did": "ubuntu",
      "name": "Ubuntu",
      "version": "18.04.3 LTS (Bionic Beaver)",
      "version_code_name": "bionic",
      "version_id": "18.04",
      "arch": "",
      "cpe": "",
      "pretty_name": "Ubuntu 18.04.3 LTS"
    }
  },
  "environments": {
    "10": [
      {
        "package_db": "var/lib/dpkg/status",
        "introduced_in": "sha256:35c102085707f703de2d9eaad8752d6fe1b8f02b5d2149f1d8357c9cc7fb7d0a",
        "distribution_id": "1"
      }
    ]
  },
  "success": true,
  "err": ""
}
</code></pre>
<h3 id="index-the-contents-of-a-manifest-responses"><a class="header" href="#index-the-contents-of-a-manifest-responses">Responses</a></h3>
<div class="table-wrapper"><table><thead><tr><th>Status</th><th>Meaning</th><th>Description</th><th>Schema</th></tr></thead><tbody>
<tr><td>201</td><td><a href="https://tools.ietf.org/html/rfc7231#section-6.3.2">Created</a></td><td>IndexReport Created</td><td><a href="reference/api.html#schemaindexreport">IndexReport</a></td></tr>
<tr><td>400</td><td><a href="https://tools.ietf.org/html/rfc7231#section-6.5.1">Bad Request</a></td><td>Bad Request</td><td><a href="reference/api.html#schemaerror">Error</a></td></tr>
<tr><td>405</td><td><a href="https://tools.ietf.org/html/rfc7231#section-6.5.5">Method Not Allowed</a></td><td>Method Not Allowed</td><td><a href="reference/api.html#schemaerror">Error</a></td></tr>
<tr><td>500</td><td><a href="https://tools.ietf.org/html/rfc7231#section-6.6.1">Internal Server Error</a></td><td>Internal Server Error</td><td><a href="reference/api.html#schemaerror">Error</a></td></tr>
</tbody></table>
</div><aside class="success">
This operation does not require authentication
</aside>
<h2 id="delete-the-indexreport-and-associated-information-for-the-given-manifest-hashes-if-they-exist"><a class="header" href="#delete-the-indexreport-and-associated-information-for-the-given-manifest-hashes-if-they-exist">Delete the IndexReport and associated information for the given Manifest hashes, if they exist.</a></h2>
<p><a id="opIdDeleteManifests"></a></p>
<blockquote>
<p>Code samples</p>
</blockquote>
<pre><code class="language-python">import requests
headers = {
  'Content-Type': 'application/json',
  'Accept': 'application/json'
}

r = requests.delete('/indexer/api/v1/index_report', headers = headers)

print(r.json())

</code></pre>
<pre><code class="language-go">package main

import (
       "bytes"
       "net/http"
)

func main() {

    headers := map[string][]string{
        "Content-Type": []string{"application/json"},
        "Accept": []string{"application/json"},
    }

    data := bytes.NewBuffer([]byte{jsonReq})
    req, err := http.NewRequest("DELETE", "/indexer/api/v1/index_report", data)
    req.Header = headers

    client := &amp;http.Client{}
    resp, err := client.Do(req)
    // ...
}

</code></pre>
<pre><code class="language-javascript">const inputBody = '[
  "sha256:fc84b5febd328eccaa913807716887b3eb5ed08bc22cc6933a9ebf82766725e3"
]';
const headers = {
  'Content-Type':'application/json',
  'Accept':'application/json'
};

fetch('/indexer/api/v1/index_report',
{
  method: 'DELETE',
  body: inputBody,
  headers: headers
})
.then(function(res) {
    return res.json();
}).then(function(body) {
    console.log(body);
});

</code></pre>
<p><code>DELETE /indexer/api/v1/index_report</code></p>
<p>Given a Manifest's content addressable hash, any data related to it will be removed if it exists.</p>
<blockquote>
<p>Body parameter</p>
</blockquote>
<pre><code class="language-json">[
  "sha256:fc84b5febd328eccaa913807716887b3eb5ed08bc22cc6933a9ebf82766725e3"
]
</code></pre>
<h3 id="delete-the-indexreport-and-associated-information-for-the-given-manifest-hashes,-if-they-exist.-parameters"><a class="header" href="#delete-the-indexreport-and-associated-information-for-the-given-manifest-hashes,-if-they-exist.-parameters">Parameters</a></h3>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>In</th><th>Type</th><th>Required</th><th>Description</th></tr></thead><tbody>
<tr><td>body</td><td>body</td><td><a href="reference/api.html#schemabulkdelete">BulkDelete</a></td><td>true</td><td>none</td></tr>
</tbody></table>
</div>
<blockquote>
<p>Example responses</p>
</blockquote>
<blockquote>
<p>200 Response</p>
</blockquote>
<pre><code class="language-json">[
  "sha256:fc84b5febd328eccaa913807716887b3eb5ed08bc22cc6933a9ebf82766725e3"
]
</code></pre>
<h3 id="delete-the-indexreport-and-associated-information-for-the-given-manifest-hashes,-if-they-exist.-responses"><a class="header" href="#delete-the-indexreport-and-associated-information-for-the-given-manifest-hashes,-if-they-exist.-responses">Responses</a></h3>
<div class="table-wrapper"><table><thead><tr><th>Status</th><th>Meaning</th><th>Description</th><th>Schema</th></tr></thead><tbody>
<tr><td>200</td><td><a href="https://tools.ietf.org/html/rfc7231#section-6.3.1">OK</a></td><td>OK</td><td><a href="reference/api.html#schemabulkdelete">BulkDelete</a></td></tr>
<tr><td>400</td><td><a href="https://tools.ietf.org/html/rfc7231#section-6.5.1">Bad Request</a></td><td>Bad Request</td><td><a href="reference/api.html#schemaerror">Error</a></td></tr>
<tr><td>500</td><td><a href="https://tools.ietf.org/html/rfc7231#section-6.6.1">Internal Server Error</a></td><td>Internal Server Error</td><td><a href="reference/api.html#schemaerror">Error</a></td></tr>
</tbody></table>
</div><aside class="success">
This operation does not require authentication
</aside>
<h2 id="delete-the-indexreport-and-associated-information-for-the-given-manifest-hash-if-exists"><a class="header" href="#delete-the-indexreport-and-associated-information-for-the-given-manifest-hash-if-exists">Delete the IndexReport and associated information for the given Manifest hash, if exists.</a></h2>
<p><a id="opIdDeleteManifest"></a></p>
<blockquote>
<p>Code samples</p>
</blockquote>
<pre><code class="language-python">import requests
headers = {
  'Accept': 'application/json'
}

r = requests.delete('/indexer/api/v1/index_report/{manifest_hash}', headers = headers)

print(r.json())

</code></pre>
<pre><code class="language-go">package main

import (
       "bytes"
       "net/http"
)

func main() {

    headers := map[string][]string{
        "Accept": []string{"application/json"},
    }

    data := bytes.NewBuffer([]byte{jsonReq})
    req, err := http.NewRequest("DELETE", "/indexer/api/v1/index_report/{manifest_hash}", data)
    req.Header = headers

    client := &amp;http.Client{}
    resp, err := client.Do(req)
    // ...
}

</code></pre>
<pre><code class="language-javascript">
const headers = {
  'Accept':'application/json'
};

fetch('/indexer/api/v1/index_report/{manifest_hash}',
{
  method: 'DELETE',

  headers: headers
})
.then(function(res) {
    return res.json();
}).then(function(body) {
    console.log(body);
});

</code></pre>
<p><code>DELETE /indexer/api/v1/index_report/{manifest_hash}</code></p>
<p>Given a Manifest's content addressable hash, any data related to it will be removed it it exists.</p>
<h3 id="delete-the-indexreport-and-associated-information-for-the-given-manifest-hash,-if-exists.-parameters"><a class="header" href="#delete-the-indexreport-and-associated-information-for-the-given-manifest-hash,-if-exists.-parameters">Parameters</a></h3>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>In</th><th>Type</th><th>Required</th><th>Description</th></tr></thead><tbody>
<tr><td>manifest_hash</td><td>path</td><td><a href="reference/api.html#schemadigest">Digest</a></td><td>true</td><td>A digest of a manifest that has been indexed previous to this request.</td></tr>
</tbody></table>
</div>
<blockquote>
<p>Example responses</p>
</blockquote>
<blockquote>
<p>400 Response</p>
</blockquote>
<pre><code class="language-json">{
  "code": "string",
  "message": "string"
}
</code></pre>
<h3 id="delete-the-indexreport-and-associated-information-for-the-given-manifest-hash,-if-exists.-responses"><a class="header" href="#delete-the-indexreport-and-associated-information-for-the-given-manifest-hash,-if-exists.-responses">Responses</a></h3>
<div class="table-wrapper"><table><thead><tr><th>Status</th><th>Meaning</th><th>Description</th><th>Schema</th></tr></thead><tbody>
<tr><td>204</td><td><a href="https://tools.ietf.org/html/rfc7231#section-6.3.5">No Content</a></td><td>OK</td><td>None</td></tr>
<tr><td>400</td><td><a href="https://tools.ietf.org/html/rfc7231#section-6.5.1">Bad Request</a></td><td>Bad Request</td><td><a href="reference/api.html#schemaerror">Error</a></td></tr>
<tr><td>500</td><td><a href="https://tools.ietf.org/html/rfc7231#section-6.6.1">Internal Server Error</a></td><td>Internal Server Error</td><td><a href="reference/api.html#schemaerror">Error</a></td></tr>
</tbody></table>
</div><aside class="success">
This operation does not require authentication
</aside>
<h2 id="retrieve-an-indexreport-for-the-given-manifest-hash-if-exists"><a class="header" href="#retrieve-an-indexreport-for-the-given-manifest-hash-if-exists">Retrieve an IndexReport for the given Manifest hash if exists.</a></h2>
<p><a id="opIdGetIndexReport"></a></p>
<blockquote>
<p>Code samples</p>
</blockquote>
<pre><code class="language-python">import requests
headers = {
  'Accept': 'application/json'
}

r = requests.get('/indexer/api/v1/index_report/{manifest_hash}', headers = headers)

print(r.json())

</code></pre>
<pre><code class="language-go">package main

import (
       "bytes"
       "net/http"
)

func main() {

    headers := map[string][]string{
        "Accept": []string{"application/json"},
    }

    data := bytes.NewBuffer([]byte{jsonReq})
    req, err := http.NewRequest("GET", "/indexer/api/v1/index_report/{manifest_hash}", data)
    req.Header = headers

    client := &amp;http.Client{}
    resp, err := client.Do(req)
    // ...
}

</code></pre>
<pre><code class="language-javascript">
const headers = {
  'Accept':'application/json'
};

fetch('/indexer/api/v1/index_report/{manifest_hash}',
{
  method: 'GET',

  headers: headers
})
.then(function(res) {
    return res.json();
}).then(function(body) {
    console.log(body);
});

</code></pre>
<p><code>GET /indexer/api/v1/index_report/{manifest_hash}</code></p>
<p>Given a Manifest's content addressable hash an IndexReport will be retrieved if exists.</p>
<h3 id="retrieve-an-indexreport-for-the-given-manifest-hash-if-exists.-parameters"><a class="header" href="#retrieve-an-indexreport-for-the-given-manifest-hash-if-exists.-parameters">Parameters</a></h3>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>In</th><th>Type</th><th>Required</th><th>Description</th></tr></thead><tbody>
<tr><td>manifest_hash</td><td>path</td><td><a href="reference/api.html#schemadigest">Digest</a></td><td>true</td><td>A digest of a manifest that has been indexed previous to this request.</td></tr>
</tbody></table>
</div>
<blockquote>
<p>Example responses</p>
</blockquote>
<blockquote>
<p>200 Response</p>
</blockquote>
<pre><code class="language-json">{
  "manifest_hash": "sha256:fc84b5febd328eccaa913807716887b3eb5ed08bc22cc6933a9ebf82766725e3",
  "state": "IndexFinished",
  "packages": {
    "10": {
      "id": "10",
      "name": "libapt-pkg5.0",
      "version": "1.6.11",
      "kind": "binary",
      "normalized_version": "",
      "arch": "x86",
      "module": "",
      "cpe": "",
      "source": {
        "id": "9",
        "name": "apt",
        "version": "1.6.11",
        "kind": "source",
        "source": null
      }
    }
  },
  "distributions": {
    "1": {
      "id": "1",
      "did": "ubuntu",
      "name": "Ubuntu",
      "version": "18.04.3 LTS (Bionic Beaver)",
      "version_code_name": "bionic",
      "version_id": "18.04",
      "arch": "",
      "cpe": "",
      "pretty_name": "Ubuntu 18.04.3 LTS"
    }
  },
  "environments": {
    "10": [
      {
        "package_db": "var/lib/dpkg/status",
        "introduced_in": "sha256:35c102085707f703de2d9eaad8752d6fe1b8f02b5d2149f1d8357c9cc7fb7d0a",
        "distribution_id": "1"
      }
    ]
  },
  "success": true,
  "err": ""
}
</code></pre>
<h3 id="retrieve-an-indexreport-for-the-given-manifest-hash-if-exists.-responses"><a class="header" href="#retrieve-an-indexreport-for-the-given-manifest-hash-if-exists.-responses">Responses</a></h3>
<div class="table-wrapper"><table><thead><tr><th>Status</th><th>Meaning</th><th>Description</th><th>Schema</th></tr></thead><tbody>
<tr><td>200</td><td><a href="https://tools.ietf.org/html/rfc7231#section-6.3.1">OK</a></td><td>IndexReport retrieved</td><td><a href="reference/api.html#schemaindexreport">IndexReport</a></td></tr>
<tr><td>400</td><td><a href="https://tools.ietf.org/html/rfc7231#section-6.5.1">Bad Request</a></td><td>Bad Request</td><td><a href="reference/api.html#schemaerror">Error</a></td></tr>
<tr><td>404</td><td><a href="https://tools.ietf.org/html/rfc7231#section-6.5.4">Not Found</a></td><td>Not Found</td><td><a href="reference/api.html#schemaerror">Error</a></td></tr>
<tr><td>405</td><td><a href="https://tools.ietf.org/html/rfc7231#section-6.5.5">Method Not Allowed</a></td><td>Method Not Allowed</td><td><a href="reference/api.html#schemaerror">Error</a></td></tr>
<tr><td>500</td><td><a href="https://tools.ietf.org/html/rfc7231#section-6.6.1">Internal Server Error</a></td><td>Internal Server Error</td><td><a href="reference/api.html#schemaerror">Error</a></td></tr>
</tbody></table>
</div><aside class="success">
This operation does not require authentication
</aside>
<h2 id="report-the-indexers-internal-configuration-and-state"><a class="header" href="#report-the-indexers-internal-configuration-and-state">Report the indexer's internal configuration and state.</a></h2>
<p><a id="opIdIndexState"></a></p>
<blockquote>
<p>Code samples</p>
</blockquote>
<pre><code class="language-python">import requests
headers = {
  'Accept': 'application/json'
}

r = requests.get('/indexer/api/v1/index_state', headers = headers)

print(r.json())

</code></pre>
<pre><code class="language-go">package main

import (
       "bytes"
       "net/http"
)

func main() {

    headers := map[string][]string{
        "Accept": []string{"application/json"},
    }

    data := bytes.NewBuffer([]byte{jsonReq})
    req, err := http.NewRequest("GET", "/indexer/api/v1/index_state", data)
    req.Header = headers

    client := &amp;http.Client{}
    resp, err := client.Do(req)
    // ...
}

</code></pre>
<pre><code class="language-javascript">
const headers = {
  'Accept':'application/json'
};

fetch('/indexer/api/v1/index_state',
{
  method: 'GET',

  headers: headers
})
.then(function(res) {
    return res.json();
}).then(function(body) {
    console.log(body);
});

</code></pre>
<p><code>GET /indexer/api/v1/index_state</code></p>
<p>The index state endpoint returns a json structure indicating the indexer's internal configuration state.
A client may be interested in this as a signal that manifests may need to be re-indexed.</p>
<blockquote>
<p>Example responses</p>
</blockquote>
<blockquote>
<p>200 Response</p>
</blockquote>
<pre><code class="language-json">{
  "state": "aae368a064d7c5a433d0bf2c4f5554cc"
}
</code></pre>
<h3 id="report-the-indexer's-internal-configuration-and-state.-responses"><a class="header" href="#report-the-indexer's-internal-configuration-and-state.-responses">Responses</a></h3>
<div class="table-wrapper"><table><thead><tr><th>Status</th><th>Meaning</th><th>Description</th><th>Schema</th></tr></thead><tbody>
<tr><td>200</td><td><a href="https://tools.ietf.org/html/rfc7231#section-6.3.1">OK</a></td><td>Indexer State</td><td><a href="reference/api.html#schemastate">State</a></td></tr>
<tr><td>304</td><td><a href="https://tools.ietf.org/html/rfc7232#section-4.1">Not Modified</a></td><td>Indexer State Unchanged</td><td>None</td></tr>
</tbody></table>
</div>
<h3 id="response-headers"><a class="header" href="#response-headers">Response Headers</a></h3>
<div class="table-wrapper"><table><thead><tr><th>Status</th><th>Header</th><th>Type</th><th>Format</th><th>Description</th></tr></thead><tbody>
<tr><td>200</td><td>Etag</td><td>string</td><td></td><td>Entity Tag</td></tr>
</tbody></table>
</div><aside class="success">
This operation does not require authentication
</aside>
<h1 id="clairv4-matcher"><a class="header" href="#clairv4-matcher">Matcher</a></h1>
<h2 id="retrieve-a-vulnerabilityreport-for-a-given-manifests-content-addressable-hash"><a class="header" href="#retrieve-a-vulnerabilityreport-for-a-given-manifests-content-addressable-hash">Retrieve a VulnerabilityReport for a given manifest's content addressable hash.</a></h2>
<p><a id="opIdGetVulnerabilityReport"></a></p>
<blockquote>
<p>Code samples</p>
</blockquote>
<pre><code class="language-python">import requests
headers = {
  'Accept': 'application/json'
}

r = requests.get('/matcher/api/v1/vulnerability_report/{manifest_hash}', headers = headers)

print(r.json())

</code></pre>
<pre><code class="language-go">package main

import (
       "bytes"
       "net/http"
)

func main() {

    headers := map[string][]string{
        "Accept": []string{"application/json"},
    }

    data := bytes.NewBuffer([]byte{jsonReq})
    req, err := http.NewRequest("GET", "/matcher/api/v1/vulnerability_report/{manifest_hash}", data)
    req.Header = headers

    client := &amp;http.Client{}
    resp, err := client.Do(req)
    // ...
}

</code></pre>
<pre><code class="language-javascript">
const headers = {
  'Accept':'application/json'
};

fetch('/matcher/api/v1/vulnerability_report/{manifest_hash}',
{
  method: 'GET',

  headers: headers
})
.then(function(res) {
    return res.json();
}).then(function(body) {
    console.log(body);
});

</code></pre>
<p><code>GET /matcher/api/v1/vulnerability_report/{manifest_hash}</code></p>
<p>Given a Manifest's content addressable hash a VulnerabilityReport will be created. The Manifest <strong>must</strong> have been Indexed first via the Index endpoint.</p>
<h3 id="retrieve-a-vulnerabilityreport-for-a-given-manifest's-content-addressable-hash.-parameters"><a class="header" href="#retrieve-a-vulnerabilityreport-for-a-given-manifest's-content-addressable-hash.-parameters">Parameters</a></h3>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>In</th><th>Type</th><th>Required</th><th>Description</th></tr></thead><tbody>
<tr><td>manifest_hash</td><td>path</td><td><a href="reference/api.html#schemadigest">Digest</a></td><td>true</td><td>A digest of a manifest that has been indexed previous to this request.</td></tr>
</tbody></table>
</div>
<blockquote>
<p>Example responses</p>
</blockquote>
<blockquote>
<p>201 Response</p>
</blockquote>
<pre><code class="language-json">{
  "manifest_hash": "sha256:fc84b5febd328eccaa913807716887b3eb5ed08bc22cc6933a9ebf82766725e3",
  "packages": {
    "10": {
      "id": "10",
      "name": "libapt-pkg5.0",
      "version": "1.6.11",
      "kind": "binary",
      "normalized_version": "",
      "arch": "x86",
      "module": "",
      "cpe": "",
      "source": {
        "id": "9",
        "name": "apt",
        "version": "1.6.11",
        "kind": "source",
        "source": null
      }
    }
  },
  "distributions": {
    "1": {
      "id": "1",
      "did": "ubuntu",
      "name": "Ubuntu",
      "version": "18.04.3 LTS (Bionic Beaver)",
      "version_code_name": "bionic",
      "version_id": "18.04",
      "arch": "",
      "cpe": "",
      "pretty_name": "Ubuntu 18.04.3 LTS"
    }
  },
  "environments": {
    "10": [
      {
        "package_db": "var/lib/dpkg/status",
        "introduced_in": "sha256:35c102085707f703de2d9eaad8752d6fe1b8f02b5d2149f1d8357c9cc7fb7d0a",
        "distribution_id": "1"
      }
    ]
  },
  "vulnerabilities": {
    "356835": {
      "id": "356835",
      "updater": "",
      "name": "CVE-2009-5155",
      "description": "In the GNU C Library (aka glibc or libc6) before 2.28, parse_reg_exp in posix/regcomp.c misparses alternatives, which allows attackers to cause a denial of service (assertion failure and application exit) or trigger an incorrect result by attempting a regular-expression match.\"",
      "links": "https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2009-5155 http://people.canonical.com/~ubuntu-security/cve/2009/CVE-2009-5155.html https://sourceware.org/bugzilla/show_bug.cgi?id=11053 https://debbugs.gnu.org/cgi/bugreport.cgi?bug=22793 https://debbugs.gnu.org/cgi/bugreport.cgi?bug=32806 https://debbugs.gnu.org/cgi/bugreport.cgi?bug=34238 https://sourceware.org/bugzilla/show_bug.cgi?id=18986\"",
      "severity": "Low",
      "normalized_severity": "Low",
      "package": {
        "id": "0",
        "name": "glibc",
        "version": "",
        "kind": "",
        "source": null,
        "package_db": "",
        "repository_hint": ""
      },
      "dist": {
        "id": "0",
        "did": "ubuntu",
        "name": "Ubuntu",
        "version": "18.04.3 LTS (Bionic Beaver)",
        "version_code_name": "bionic",
        "version_id": "18.04",
        "arch": "",
        "cpe": "",
        "pretty_name": ""
      },
      "repo": {
        "id": "0",
        "name": "Ubuntu 18.04.3 LTS",
        "key": "",
        "uri": ""
      },
      "issued": "2019-10-12T07:20:50.52Z",
      "fixed_in_version": "2.28-0ubuntu1"
    }
  },
  "package_vulnerabilities": {
    "10": [
      "356835"
    ]
  }
}
</code></pre>
<h3 id="retrieve-a-vulnerabilityreport-for-a-given-manifest's-content-addressable-hash.-responses"><a class="header" href="#retrieve-a-vulnerabilityreport-for-a-given-manifest's-content-addressable-hash.-responses">Responses</a></h3>
<div class="table-wrapper"><table><thead><tr><th>Status</th><th>Meaning</th><th>Description</th><th>Schema</th></tr></thead><tbody>
<tr><td>201</td><td><a href="https://tools.ietf.org/html/rfc7231#section-6.3.2">Created</a></td><td>VulnerabilityReport Created</td><td><a href="reference/api.html#schemavulnerabilityreport">VulnerabilityReport</a></td></tr>
<tr><td>400</td><td><a href="https://tools.ietf.org/html/rfc7231#section-6.5.1">Bad Request</a></td><td>Bad Request</td><td><a href="reference/api.html#schemaerror">Error</a></td></tr>
<tr><td>404</td><td><a href="https://tools.ietf.org/html/rfc7231#section-6.5.4">Not Found</a></td><td>Not Found</td><td><a href="reference/api.html#schemaerror">Error</a></td></tr>
<tr><td>405</td><td><a href="https://tools.ietf.org/html/rfc7231#section-6.5.5">Method Not Allowed</a></td><td>Method Not Allowed</td><td><a href="reference/api.html#schemaerror">Error</a></td></tr>
<tr><td>500</td><td><a href="https://tools.ietf.org/html/rfc7231#section-6.6.1">Internal Server Error</a></td><td>Internal Server Error</td><td><a href="reference/api.html#schemaerror">Error</a></td></tr>
</tbody></table>
</div><aside class="success">
This operation does not require authentication
</aside>
<h1 id="schemas"><a class="header" href="#schemas">Schemas</a></h1>
<h2 id="tocS_Page"><a class="header" href="#tocS_Page">Page</a></h2>
<!-- backwards compatibility -->
<a id="schemapage"></a>
<a id="schema_Page"></a>
<a id="tocSpage"></a>
<a id="tocspage"></a>
<pre><code class="language-json">{
  "size": 1,
  "next": "1b4d0db2-e757-4150-bbbb-543658144205"
}

</code></pre>
<p>Page</p>
<h3 id="properties"><a class="header" href="#properties">Properties</a></h3>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Required</th><th>Restrictions</th><th>Description</th></tr></thead><tbody>
<tr><td>size</td><td>int</td><td>false</td><td>none</td><td>The maximum number of elements in a page</td></tr>
<tr><td>next</td><td>string</td><td>false</td><td>none</td><td>The next id to submit to the api to continue paging</td></tr>
</tbody></table>
</div><h2 id="tocS_PagedNotifications"><a class="header" href="#tocS_PagedNotifications">PagedNotifications</a></h2>
<!-- backwards compatibility -->
<a id="schemapagednotifications"></a>
<a id="schema_PagedNotifications"></a>
<a id="tocSpagednotifications"></a>
<a id="tocspagednotifications"></a>
<pre><code class="language-json">{
  "page": {
    "size": 100,
    "next": "1b4d0db2-e757-4150-bbbb-543658144205"
  },
  "notifications": [
    {
      "id": "5e4b387e-88d3-4364-86fd-063447a6fad2",
      "manifest": "sha256:35c102085707f703de2d9eaad8752d6fe1b8f02b5d2149f1d8357c9cc7fb7d0a",
      "reason": "added",
      "vulnerability": {
        "name": "CVE-2009-5155",
        "fixed_in_version": "v0.0.1",
        "links": "http://link-to-advisory",
        "description": "In the GNU C Library (aka glibc or libc6) before 2.28, parse_reg_exp in posix/regcomp.c misparses alternatives, which allows attackers to cause a denial of service (assertion failure and application exit) or trigger an incorrect result by attempting a regular-expression match.\"",
        "normalized_severity": "Unknown",
        "package": {
          "id": "10",
          "name": "libapt-pkg5.0",
          "version": "1.6.11",
          "kind": "binary",
          "normalized_version": "",
          "arch": "x86",
          "module": "",
          "cpe": "",
          "source": {
            "id": "9",
            "name": "apt",
            "version": "1.6.11",
            "kind": "source",
            "source": null
          }
        },
        "distribution": {
          "id": "1",
          "did": "ubuntu",
          "name": "Ubuntu",
          "version": "18.04.3 LTS (Bionic Beaver)",
          "version_code_name": "bionic",
          "version_id": "18.04",
          "arch": "",
          "cpe": "",
          "pretty_name": "Ubuntu 18.04.3 LTS"
        },
        "repository": {
          "id": "string",
          "name": "string",
          "key": "string",
          "uri": "string",
          "cpe": "string"
        }
      }
    }
  ]
}

</code></pre>
<p>PagedNotifications</p>
<h3 id="properties-1"><a class="header" href="#properties-1">Properties</a></h3>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Required</th><th>Restrictions</th><th>Description</th></tr></thead><tbody>
<tr><td>page</td><td>object</td><td>false</td><td>none</td><td>A page object informing the client the next page to retrieve. If page.next becomes "-1" the client should stop paging.</td></tr>
<tr><td>notifications</td><td>[<a href="reference/api.html#schemanotification">Notification</a>]</td><td>false</td><td>none</td><td>A list of notifications within this page</td></tr>
</tbody></table>
</div><h2 id="tocS_Callback"><a class="header" href="#tocS_Callback">Callback</a></h2>
<!-- backwards compatibility -->
<a id="schemacallback"></a>
<a id="schema_Callback"></a>
<a id="tocScallback"></a>
<a id="tocscallback"></a>
<pre><code class="language-json">{
  "notification_id": "269886f3-0146-4f08-9bf7-cb1138d48643",
  "callback": "http://clair-notifier/notifier/api/v1/notification/269886f3-0146-4f08-9bf7-cb1138d48643"
}

</code></pre>
<p>Callback</p>
<h3 id="properties-2"><a class="header" href="#properties-2">Properties</a></h3>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Required</th><th>Restrictions</th><th>Description</th></tr></thead><tbody>
<tr><td>notification_id</td><td>string</td><td>false</td><td>none</td><td>the unique identifier for this set of notifications</td></tr>
<tr><td>callback</td><td>string</td><td>false</td><td>none</td><td>the url where notifications can be retrieved</td></tr>
</tbody></table>
</div><h2 id="tocS_VulnSummary"><a class="header" href="#tocS_VulnSummary">VulnSummary</a></h2>
<!-- backwards compatibility -->
<a id="schemavulnsummary"></a>
<a id="schema_VulnSummary"></a>
<a id="tocSvulnsummary"></a>
<a id="tocsvulnsummary"></a>
<pre><code class="language-json">{
  "name": "CVE-2009-5155",
  "fixed_in_version": "v0.0.1",
  "links": "http://link-to-advisory",
  "description": "In the GNU C Library (aka glibc or libc6) before 2.28, parse_reg_exp in posix/regcomp.c misparses alternatives, which allows attackers to cause a denial of service (assertion failure and application exit) or trigger an incorrect result by attempting a regular-expression match.\"",
  "normalized_severity": "Unknown",
  "package": {
    "id": "10",
    "name": "libapt-pkg5.0",
    "version": "1.6.11",
    "kind": "binary",
    "normalized_version": "",
    "arch": "x86",
    "module": "",
    "cpe": "",
    "source": {
      "id": "9",
      "name": "apt",
      "version": "1.6.11",
      "kind": "source",
      "source": null
    }
  },
  "distribution": {
    "id": "1",
    "did": "ubuntu",
    "name": "Ubuntu",
    "version": "18.04.3 LTS (Bionic Beaver)",
    "version_code_name": "bionic",
    "version_id": "18.04",
    "arch": "",
    "cpe": "",
    "pretty_name": "Ubuntu 18.04.3 LTS"
  },
  "repository": {
    "id": "string",
    "name": "string",
    "key": "string",
    "uri": "string",
    "cpe": "string"
  }
}

</code></pre>
<p>VulnSummary</p>
<h3 id="properties-3"><a class="header" href="#properties-3">Properties</a></h3>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Required</th><th>Restrictions</th><th>Description</th></tr></thead><tbody>
<tr><td>name</td><td>string</td><td>false</td><td>none</td><td>the vulnerability name</td></tr>
<tr><td>fixed_in_version</td><td>string</td><td>false</td><td>none</td><td>The version which the vulnerability is fixed in. Empty if not fixed.</td></tr>
<tr><td>links</td><td>string</td><td>false</td><td>none</td><td>links to external information about vulnerability</td></tr>
<tr><td>description</td><td>string</td><td>false</td><td>none</td><td>the vulnerability name</td></tr>
<tr><td>normalized_severity</td><td>string</td><td>false</td><td>none</td><td>A well defined set of severity strings guaranteed to be present.</td></tr>
<tr><td>package</td><td><a href="reference/api.html#schemapackage">Package</a></td><td>false</td><td>none</td><td>A package discovered by indexing a Manifest</td></tr>
<tr><td>distribution</td><td><a href="reference/api.html#schemadistribution">Distribution</a></td><td>false</td><td>none</td><td>An indexed distribution discovered in a layer. See https://www.freedesktop.org/software/systemd/man/os-release.html for explanations and example of fields.</td></tr>
<tr><td>repository</td><td><a href="reference/api.html#schemarepository">Repository</a></td><td>false</td><td>none</td><td>A package repository</td></tr>
</tbody></table>
</div>
<h4 id="enumerated-values"><a class="header" href="#enumerated-values">Enumerated Values</a></h4>
<div class="table-wrapper"><table><thead><tr><th>Property</th><th>Value</th></tr></thead><tbody>
<tr><td>normalized_severity</td><td>Unknown</td></tr>
<tr><td>normalized_severity</td><td>Negligible</td></tr>
<tr><td>normalized_severity</td><td>Low</td></tr>
<tr><td>normalized_severity</td><td>Medium</td></tr>
<tr><td>normalized_severity</td><td>High</td></tr>
<tr><td>normalized_severity</td><td>Critical</td></tr>
</tbody></table>
</div><h2 id="tocS_Notification"><a class="header" href="#tocS_Notification">Notification</a></h2>
<!-- backwards compatibility -->
<a id="schemanotification"></a>
<a id="schema_Notification"></a>
<a id="tocSnotification"></a>
<a id="tocsnotification"></a>
<pre><code class="language-json">{
  "id": "5e4b387e-88d3-4364-86fd-063447a6fad2",
  "manifest": "sha256:35c102085707f703de2d9eaad8752d6fe1b8f02b5d2149f1d8357c9cc7fb7d0a",
  "reason": "added",
  "vulnerability": {
    "name": "CVE-2009-5155",
    "fixed_in_version": "v0.0.1",
    "links": "http://link-to-advisory",
    "description": "In the GNU C Library (aka glibc or libc6) before 2.28, parse_reg_exp in posix/regcomp.c misparses alternatives, which allows attackers to cause a denial of service (assertion failure and application exit) or trigger an incorrect result by attempting a regular-expression match.\"",
    "normalized_severity": "Unknown",
    "package": {
      "id": "10",
      "name": "libapt-pkg5.0",
      "version": "1.6.11",
      "kind": "binary",
      "normalized_version": "",
      "arch": "x86",
      "module": "",
      "cpe": "",
      "source": {
        "id": "9",
        "name": "apt",
        "version": "1.6.11",
        "kind": "source",
        "source": null
      }
    },
    "distribution": {
      "id": "1",
      "did": "ubuntu",
      "name": "Ubuntu",
      "version": "18.04.3 LTS (Bionic Beaver)",
      "version_code_name": "bionic",
      "version_id": "18.04",
      "arch": "",
      "cpe": "",
      "pretty_name": "Ubuntu 18.04.3 LTS"
    },
    "repository": {
      "id": "string",
      "name": "string",
      "key": "string",
      "uri": "string",
      "cpe": "string"
    }
  }
}

</code></pre>
<p>Notification</p>
<h3 id="properties-4"><a class="header" href="#properties-4">Properties</a></h3>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Required</th><th>Restrictions</th><th>Description</th></tr></thead><tbody>
<tr><td>id</td><td>string</td><td>false</td><td>none</td><td>a unique identifier for this notification</td></tr>
<tr><td>manifest</td><td>string</td><td>false</td><td>none</td><td>The hash of the manifest affected by the provided vulnerability.</td></tr>
<tr><td>reason</td><td>string</td><td>false</td><td>none</td><td>the reason for the notifcation, [added</td></tr>
<tr><td>vulnerability</td><td><a href="reference/api.html#schemavulnsummary">VulnSummary</a></td><td>false</td><td>none</td><td>A summary of a vulnerability</td></tr>
</tbody></table>
</div><h2 id="tocS_Environment"><a class="header" href="#tocS_Environment">Environment</a></h2>
<!-- backwards compatibility -->
<a id="schemaenvironment"></a>
<a id="schema_Environment"></a>
<a id="tocSenvironment"></a>
<a id="tocsenvironment"></a>
<pre><code class="language-json">{
  "package_db": "var/lib/dpkg/status",
  "introduced_in": "sha256:fc84b5febd328eccaa913807716887b3eb5ed08bc22cc6933a9ebf82766725e3",
  "distribution_id": "1"
}

</code></pre>
<p>Environment</p>
<h3 id="properties-5"><a class="header" href="#properties-5">Properties</a></h3>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Required</th><th>Restrictions</th><th>Description</th></tr></thead><tbody>
<tr><td>package_db</td><td>string</td><td>true</td><td>none</td><td>The filesystem path or unique identifier of a package database.</td></tr>
<tr><td>introduced_in</td><td><a href="reference/api.html#schemadigest">Digest</a></td><td>true</td><td>none</td><td>A digest string with prefixed algorithm. The format is described here: https://github.com/opencontainers/image-spec/blob/master/descriptor.md#digests<br>Digests are used throughout the API to identify Layers and Manifests.</td></tr>
<tr><td>distribution_id</td><td>string</td><td>true</td><td>none</td><td>The distribution ID found in an associated IndexReport or VulnerabilityReport.</td></tr>
</tbody></table>
</div><h2 id="tocS_IndexReport"><a class="header" href="#tocS_IndexReport">IndexReport</a></h2>
<!-- backwards compatibility -->
<a id="schemaindexreport"></a>
<a id="schema_IndexReport"></a>
<a id="tocSindexreport"></a>
<a id="tocsindexreport"></a>
<pre><code class="language-json">{
  "manifest_hash": "sha256:fc84b5febd328eccaa913807716887b3eb5ed08bc22cc6933a9ebf82766725e3",
  "state": "IndexFinished",
  "packages": {
    "10": {
      "id": "10",
      "name": "libapt-pkg5.0",
      "version": "1.6.11",
      "kind": "binary",
      "normalized_version": "",
      "arch": "x86",
      "module": "",
      "cpe": "",
      "source": {
        "id": "9",
        "name": "apt",
        "version": "1.6.11",
        "kind": "source",
        "source": null
      }
    }
  },
  "distributions": {
    "1": {
      "id": "1",
      "did": "ubuntu",
      "name": "Ubuntu",
      "version": "18.04.3 LTS (Bionic Beaver)",
      "version_code_name": "bionic",
      "version_id": "18.04",
      "arch": "",
      "cpe": "",
      "pretty_name": "Ubuntu 18.04.3 LTS"
    }
  },
  "environments": {
    "10": [
      {
        "package_db": "var/lib/dpkg/status",
        "introduced_in": "sha256:35c102085707f703de2d9eaad8752d6fe1b8f02b5d2149f1d8357c9cc7fb7d0a",
        "distribution_id": "1"
      }
    ]
  },
  "success": true,
  "err": ""
}

</code></pre>
<p>IndexReport</p>
<h3 id="properties-6"><a class="header" href="#properties-6">Properties</a></h3>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Required</th><th>Restrictions</th><th>Description</th></tr></thead><tbody>
<tr><td>manifest_hash</td><td><a href="reference/api.html#schemadigest">Digest</a></td><td>true</td><td>none</td><td>A digest string with prefixed algorithm. The format is described here: https://github.com/opencontainers/image-spec/blob/master/descriptor.md#digests<br>Digests are used throughout the API to identify Layers and Manifests.</td></tr>
<tr><td>state</td><td>string</td><td>true</td><td>none</td><td>The current state of the index operation</td></tr>
<tr><td>packages</td><td>object</td><td>true</td><td>none</td><td>A map of Package objects indexed by Package.id</td></tr>
<tr><td>» <strong>additionalProperties</strong></td><td><a href="reference/api.html#schemapackage">Package</a></td><td>false</td><td>none</td><td>A package discovered by indexing a Manifest</td></tr>
<tr><td>distributions</td><td>object</td><td>true</td><td>none</td><td>A map of Distribution objects keyed by their Distribution.id discovered in the manifest.</td></tr>
<tr><td>» <strong>additionalProperties</strong></td><td><a href="reference/api.html#schemadistribution">Distribution</a></td><td>false</td><td>none</td><td>An indexed distribution discovered in a layer. See https://www.freedesktop.org/software/systemd/man/os-release.html for explanations and example of fields.</td></tr>
<tr><td>environments</td><td>object</td><td>true</td><td>none</td><td>A map of lists containing Environment objects keyed by the associated Package.id.</td></tr>
<tr><td>» <strong>additionalProperties</strong></td><td>[<a href="reference/api.html#schemaenvironment">Environment</a>]</td><td>false</td><td>none</td><td>[The environment a particular package was discovered in.]</td></tr>
<tr><td>success</td><td>boolean</td><td>true</td><td>none</td><td>A bool indicating succcessful index</td></tr>
<tr><td>err</td><td>string</td><td>true</td><td>none</td><td>An error message on event of unsuccessful index</td></tr>
</tbody></table>
</div><h2 id="tocS_VulnerabilityReport"><a class="header" href="#tocS_VulnerabilityReport">VulnerabilityReport</a></h2>
<!-- backwards compatibility -->
<a id="schemavulnerabilityreport"></a>
<a id="schema_VulnerabilityReport"></a>
<a id="tocSvulnerabilityreport"></a>
<a id="tocsvulnerabilityreport"></a>
<pre><code class="language-json">{
  "manifest_hash": "sha256:fc84b5febd328eccaa913807716887b3eb5ed08bc22cc6933a9ebf82766725e3",
  "packages": {
    "10": {
      "id": "10",
      "name": "libapt-pkg5.0",
      "version": "1.6.11",
      "kind": "binary",
      "normalized_version": "",
      "arch": "x86",
      "module": "",
      "cpe": "",
      "source": {
        "id": "9",
        "name": "apt",
        "version": "1.6.11",
        "kind": "source",
        "source": null
      }
    }
  },
  "distributions": {
    "1": {
      "id": "1",
      "did": "ubuntu",
      "name": "Ubuntu",
      "version": "18.04.3 LTS (Bionic Beaver)",
      "version_code_name": "bionic",
      "version_id": "18.04",
      "arch": "",
      "cpe": "",
      "pretty_name": "Ubuntu 18.04.3 LTS"
    }
  },
  "environments": {
    "10": [
      {
        "package_db": "var/lib/dpkg/status",
        "introduced_in": "sha256:35c102085707f703de2d9eaad8752d6fe1b8f02b5d2149f1d8357c9cc7fb7d0a",
        "distribution_id": "1"
      }
    ]
  },
  "vulnerabilities": {
    "356835": {
      "id": "356835",
      "updater": "",
      "name": "CVE-2009-5155",
      "description": "In the GNU C Library (aka glibc or libc6) before 2.28, parse_reg_exp in posix/regcomp.c misparses alternatives, which allows attackers to cause a denial of service (assertion failure and application exit) or trigger an incorrect result by attempting a regular-expression match.\"",
      "links": "https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2009-5155 http://people.canonical.com/~ubuntu-security/cve/2009/CVE-2009-5155.html https://sourceware.org/bugzilla/show_bug.cgi?id=11053 https://debbugs.gnu.org/cgi/bugreport.cgi?bug=22793 https://debbugs.gnu.org/cgi/bugreport.cgi?bug=32806 https://debbugs.gnu.org/cgi/bugreport.cgi?bug=34238 https://sourceware.org/bugzilla/show_bug.cgi?id=18986\"",
      "severity": "Low",
      "normalized_severity": "Low",
      "package": {
        "id": "0",
        "name": "glibc",
        "version": "",
        "kind": "",
        "source": null,
        "package_db": "",
        "repository_hint": ""
      },
      "dist": {
        "id": "0",
        "did": "ubuntu",
        "name": "Ubuntu",
        "version": "18.04.3 LTS (Bionic Beaver)",
        "version_code_name": "bionic",
        "version_id": "18.04",
        "arch": "",
        "cpe": "",
        "pretty_name": ""
      },
      "repo": {
        "id": "0",
        "name": "Ubuntu 18.04.3 LTS",
        "key": "",
        "uri": ""
      },
      "issued": "2019-10-12T07:20:50.52Z",
      "fixed_in_version": "2.28-0ubuntu1"
    }
  },
  "package_vulnerabilities": {
    "10": [
      "356835"
    ]
  }
}

</code></pre>
<p>VulnerabilityReport</p>
<h3 id="properties-7"><a class="header" href="#properties-7">Properties</a></h3>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Required</th><th>Restrictions</th><th>Description</th></tr></thead><tbody>
<tr><td>manifest_hash</td><td><a href="reference/api.html#schemadigest">Digest</a></td><td>true</td><td>none</td><td>A digest string with prefixed algorithm. The format is described here: https://github.com/opencontainers/image-spec/blob/master/descriptor.md#digests<br>Digests are used throughout the API to identify Layers and Manifests.</td></tr>
<tr><td>packages</td><td>object</td><td>true</td><td>none</td><td>A map of Package objects indexed by Package.id</td></tr>
<tr><td>» <strong>additionalProperties</strong></td><td><a href="reference/api.html#schemapackage">Package</a></td><td>false</td><td>none</td><td>A package discovered by indexing a Manifest</td></tr>
<tr><td>distributions</td><td>object</td><td>true</td><td>none</td><td>A map of Distribution objects indexed by Distribution.id.</td></tr>
<tr><td>» <strong>additionalProperties</strong></td><td><a href="reference/api.html#schemadistribution">Distribution</a></td><td>false</td><td>none</td><td>An indexed distribution discovered in a layer. See https://www.freedesktop.org/software/systemd/man/os-release.html for explanations and example of fields.</td></tr>
<tr><td>environments</td><td>object</td><td>true</td><td>none</td><td>A mapping of Environment lists indexed by Package.id</td></tr>
<tr><td>» <strong>additionalProperties</strong></td><td>[<a href="reference/api.html#schemaenvironment">Environment</a>]</td><td>false</td><td>none</td><td>[The environment a particular package was discovered in.]</td></tr>
<tr><td>vulnerabilities</td><td>object</td><td>true</td><td>none</td><td>A map of Vulnerabilities indexed by Vulnerability.id</td></tr>
<tr><td>» <strong>additionalProperties</strong></td><td><a href="reference/api.html#schemavulnerability">Vulnerability</a></td><td>false</td><td>none</td><td>A unique vulnerability indexed by Clair</td></tr>
<tr><td>package_vulnerabilities</td><td>object</td><td>true</td><td>none</td><td>A mapping of Vulnerability.id lists indexed by Package.id.</td></tr>
<tr><td>» <strong>additionalProperties</strong></td><td>[string]</td><td>false</td><td>none</td><td>none</td></tr>
</tbody></table>
</div><h2 id="tocS_Vulnerability"><a class="header" href="#tocS_Vulnerability">Vulnerability</a></h2>
<!-- backwards compatibility -->
<a id="schemavulnerability"></a>
<a id="schema_Vulnerability"></a>
<a id="tocSvulnerability"></a>
<a id="tocsvulnerability"></a>
<pre><code class="language-json">{
  "id": "356835",
  "updater": "",
  "name": "CVE-2009-5155",
  "description": "In the GNU C Library (aka glibc or libc6) before 2.28, parse_reg_exp in posix/regcomp.c misparses alternatives, which allows attackers to cause a denial of service (assertion failure and application exit) or trigger an incorrect result by attempting a regular-expression match.\"",
  "links": "https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2009-5155 http://people.canonical.com/~ubuntu-security/cve/2009/CVE-2009-5155.html https://sourceware.org/bugzilla/show_bug.cgi?id=11053 https://debbugs.gnu.org/cgi/bugreport.cgi?bug=22793 https://debbugs.gnu.org/cgi/bugreport.cgi?bug=32806 https://debbugs.gnu.org/cgi/bugreport.cgi?bug=34238 https://sourceware.org/bugzilla/show_bug.cgi?id=18986\"",
  "severity": "Low",
  "normalized_severity": "Low",
  "package": {
    "id": "0",
    "name": "glibc",
    "version": "",
    "kind": "",
    "source": null,
    "package_db": "",
    "repository_hint": ""
  },
  "dist": {
    "id": "0",
    "did": "ubuntu",
    "name": "Ubuntu",
    "version": "18.04.3 LTS (Bionic Beaver)",
    "version_code_name": "bionic",
    "version_id": "18.04",
    "arch": "",
    "cpe": "",
    "pretty_name": ""
  },
  "repo": {
    "id": "0",
    "name": "Ubuntu 18.04.3 LTS",
    "key": "",
    "uri": ""
  },
  "issued": "2019-10-12T07:20:50.52Z",
  "fixed_in_version": "2.28-0ubuntu1",
  "x-widdershins-oldRef": "#/components/examples/Vulnerability/value"
}

</code></pre>
<p>Vulnerability</p>
<h3 id="properties-8"><a class="header" href="#properties-8">Properties</a></h3>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Required</th><th>Restrictions</th><th>Description</th></tr></thead><tbody>
<tr><td>id</td><td>string</td><td>true</td><td>none</td><td>A unique ID representing this vulnerability.</td></tr>
<tr><td>updater</td><td>string</td><td>true</td><td>none</td><td>A unique ID representing this vulnerability.</td></tr>
<tr><td>name</td><td>string</td><td>true</td><td>none</td><td>Name of this specific vulnerability.</td></tr>
<tr><td>description</td><td>string</td><td>true</td><td>none</td><td>A description of this specific vulnerability.</td></tr>
<tr><td>links</td><td>string</td><td>true</td><td>none</td><td>A space separate list of links to any external information.</td></tr>
<tr><td>severity</td><td>string</td><td>true</td><td>none</td><td>A severity keyword taken verbatim from the vulnerability source.</td></tr>
<tr><td>normalized_severity</td><td>string</td><td>true</td><td>none</td><td>A well defined set of severity strings guaranteed to be present.</td></tr>
<tr><td>package</td><td><a href="reference/api.html#schemapackage">Package</a></td><td>false</td><td>none</td><td>A package discovered by indexing a Manifest</td></tr>
<tr><td>distribution</td><td><a href="reference/api.html#schemadistribution">Distribution</a></td><td>false</td><td>none</td><td>An indexed distribution discovered in a layer. See https://www.freedesktop.org/software/systemd/man/os-release.html for explanations and example of fields.</td></tr>
<tr><td>repository</td><td><a href="reference/api.html#schemarepository">Repository</a></td><td>false</td><td>none</td><td>A package repository</td></tr>
<tr><td>issued</td><td>string</td><td>false</td><td>none</td><td>The timestamp in which the vulnerability was issued</td></tr>
<tr><td>range</td><td>string</td><td>false</td><td>none</td><td>The range of package versions affected by this vulnerability.</td></tr>
<tr><td>fixed_in_version</td><td>string</td><td>true</td><td>none</td><td>A unique ID representing this vulnerability.</td></tr>
</tbody></table>
</div>
<h4 id="enumerated-values-1"><a class="header" href="#enumerated-values-1">Enumerated Values</a></h4>
<div class="table-wrapper"><table><thead><tr><th>Property</th><th>Value</th></tr></thead><tbody>
<tr><td>normalized_severity</td><td>Unknown</td></tr>
<tr><td>normalized_severity</td><td>Negligible</td></tr>
<tr><td>normalized_severity</td><td>Low</td></tr>
<tr><td>normalized_severity</td><td>Medium</td></tr>
<tr><td>normalized_severity</td><td>High</td></tr>
<tr><td>normalized_severity</td><td>Critical</td></tr>
</tbody></table>
</div><h2 id="tocS_Distribution"><a class="header" href="#tocS_Distribution">Distribution</a></h2>
<!-- backwards compatibility -->
<a id="schemadistribution"></a>
<a id="schema_Distribution"></a>
<a id="tocSdistribution"></a>
<a id="tocsdistribution"></a>
<pre><code class="language-json">{
  "id": "1",
  "did": "ubuntu",
  "name": "Ubuntu",
  "version": "18.04.3 LTS (Bionic Beaver)",
  "version_code_name": "bionic",
  "version_id": "18.04",
  "arch": "",
  "cpe": "",
  "pretty_name": "Ubuntu 18.04.3 LTS",
  "x-widdershins-oldRef": "#/components/examples/Distribution/value"
}

</code></pre>
<p>Distribution</p>
<h3 id="properties-9"><a class="header" href="#properties-9">Properties</a></h3>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Required</th><th>Restrictions</th><th>Description</th></tr></thead><tbody>
<tr><td>id</td><td>string</td><td>true</td><td>none</td><td>A unique ID representing this distribution</td></tr>
<tr><td>did</td><td>string</td><td>true</td><td>none</td><td>none</td></tr>
<tr><td>name</td><td>string</td><td>true</td><td>none</td><td>none</td></tr>
<tr><td>version</td><td>string</td><td>true</td><td>none</td><td>none</td></tr>
<tr><td>version_code_name</td><td>string</td><td>true</td><td>none</td><td>none</td></tr>
<tr><td>version_id</td><td>string</td><td>true</td><td>none</td><td>none</td></tr>
<tr><td>arch</td><td>string</td><td>true</td><td>none</td><td>none</td></tr>
<tr><td>cpe</td><td>string</td><td>true</td><td>none</td><td>none</td></tr>
<tr><td>pretty_name</td><td>string</td><td>true</td><td>none</td><td>none</td></tr>
</tbody></table>
</div><h2 id="tocS_SourcePackage"><a class="header" href="#tocS_SourcePackage">SourcePackage</a></h2>
<!-- backwards compatibility -->
<a id="schemasourcepackage"></a>
<a id="schema_SourcePackage"></a>
<a id="tocSsourcepackage"></a>
<a id="tocssourcepackage"></a>
<pre><code class="language-json">{
  "id": "10",
  "name": "libapt-pkg5.0",
  "version": "1.6.11",
  "kind": "binary",
  "normalized_version": "",
  "arch": "x86",
  "module": "",
  "cpe": "",
  "source": {
    "id": "9",
    "name": "apt",
    "version": "1.6.11",
    "kind": "source",
    "source": null
  },
  "x-widdershins-oldRef": "#/components/examples/Package/value"
}

</code></pre>
<p>SourcePackage</p>
<h3 id="properties-10"><a class="header" href="#properties-10">Properties</a></h3>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Required</th><th>Restrictions</th><th>Description</th></tr></thead><tbody>
<tr><td>id</td><td>string</td><td>true</td><td>none</td><td>A unique ID representing this package</td></tr>
<tr><td>name</td><td>string</td><td>true</td><td>none</td><td>Name of the Package</td></tr>
<tr><td>version</td><td>string</td><td>true</td><td>none</td><td>Version of the Package</td></tr>
<tr><td>kind</td><td>string</td><td>false</td><td>none</td><td>Kind of package. Source</td></tr>
<tr><td>source</td><td>string</td><td>false</td><td>none</td><td>none</td></tr>
<tr><td>normalized_version</td><td><a href="reference/api.html#schemaversion">Version</a></td><td>false</td><td>none</td><td>Version is a normalized claircore version, composed of a "kind" and an array of integers such that two versions of the same kind have the correct ordering when the integers are compared pair-wise.</td></tr>
<tr><td>arch</td><td>string</td><td>false</td><td>none</td><td>none</td></tr>
<tr><td>module</td><td>string</td><td>false</td><td>none</td><td>none</td></tr>
<tr><td>cpe</td><td>string</td><td>false</td><td>none</td><td>A CPE identifying the package</td></tr>
</tbody></table>
</div><h2 id="tocS_Package"><a class="header" href="#tocS_Package">Package</a></h2>
<!-- backwards compatibility -->
<a id="schemapackage"></a>
<a id="schema_Package"></a>
<a id="tocSpackage"></a>
<a id="tocspackage"></a>
<pre><code class="language-json">{
  "id": "10",
  "name": "libapt-pkg5.0",
  "version": "1.6.11",
  "kind": "binary",
  "normalized_version": "",
  "arch": "x86",
  "module": "",
  "cpe": "",
  "source": {
    "id": "9",
    "name": "apt",
    "version": "1.6.11",
    "kind": "source",
    "source": null
  },
  "x-widdershins-oldRef": "#/components/examples/Package/value"
}

</code></pre>
<p>Package</p>
<h3 id="properties-11"><a class="header" href="#properties-11">Properties</a></h3>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Required</th><th>Restrictions</th><th>Description</th></tr></thead><tbody>
<tr><td>id</td><td>string</td><td>true</td><td>none</td><td>A unique ID representing this package</td></tr>
<tr><td>name</td><td>string</td><td>true</td><td>none</td><td>Name of the Package</td></tr>
<tr><td>version</td><td>string</td><td>true</td><td>none</td><td>Version of the Package</td></tr>
<tr><td>kind</td><td>string</td><td>false</td><td>none</td><td>Kind of package. Source</td></tr>
<tr><td>source</td><td><a href="reference/api.html#schemasourcepackage">SourcePackage</a></td><td>false</td><td>none</td><td>A source package affiliated with a Package</td></tr>
<tr><td>normalized_version</td><td><a href="reference/api.html#schemaversion">Version</a></td><td>false</td><td>none</td><td>Version is a normalized claircore version, composed of a "kind" and an array of integers such that two versions of the same kind have the correct ordering when the integers are compared pair-wise.</td></tr>
<tr><td>arch</td><td>string</td><td>false</td><td>none</td><td>The package's target system architecture</td></tr>
<tr><td>module</td><td>string</td><td>false</td><td>none</td><td>A module further defining a namespace for a package</td></tr>
<tr><td>cpe</td><td>string</td><td>false</td><td>none</td><td>A CPE identifying the package</td></tr>
</tbody></table>
</div><h2 id="tocS_Repository"><a class="header" href="#tocS_Repository">Repository</a></h2>
<!-- backwards compatibility -->
<a id="schemarepository"></a>
<a id="schema_Repository"></a>
<a id="tocSrepository"></a>
<a id="tocsrepository"></a>
<pre><code class="language-json">{
  "id": "string",
  "name": "string",
  "key": "string",
  "uri": "string",
  "cpe": "string"
}

</code></pre>
<p>Repository</p>
<h3 id="properties-12"><a class="header" href="#properties-12">Properties</a></h3>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Required</th><th>Restrictions</th><th>Description</th></tr></thead><tbody>
<tr><td>id</td><td>string</td><td>false</td><td>none</td><td>none</td></tr>
<tr><td>name</td><td>string</td><td>false</td><td>none</td><td>none</td></tr>
<tr><td>key</td><td>string</td><td>false</td><td>none</td><td>none</td></tr>
<tr><td>uri</td><td>string</td><td>false</td><td>none</td><td>none</td></tr>
<tr><td>cpe</td><td>string</td><td>false</td><td>none</td><td>none</td></tr>
</tbody></table>
</div><h2 id="tocS_Version"><a class="header" href="#tocS_Version">Version</a></h2>
<!-- backwards compatibility -->
<a id="schemaversion"></a>
<a id="schema_Version"></a>
<a id="tocSversion"></a>
<a id="tocsversion"></a>
<pre><code class="language-json">"pep440:0.0.0.0.0.0.0.0.0"

</code></pre>
<p>Version</p>
<h3 id="properties-13"><a class="header" href="#properties-13">Properties</a></h3>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Required</th><th>Restrictions</th><th>Description</th></tr></thead><tbody>
<tr><td>Version</td><td>string</td><td>false</td><td>none</td><td>Version is a normalized claircore version, composed of a "kind" and an array of integers such that two versions of the same kind have the correct ordering when the integers are compared pair-wise.</td></tr>
</tbody></table>
</div><h2 id="tocS_Manifest"><a class="header" href="#tocS_Manifest">Manifest</a></h2>
<!-- backwards compatibility -->
<a id="schemamanifest"></a>
<a id="schema_Manifest"></a>
<a id="tocSmanifest"></a>
<a id="tocsmanifest"></a>
<pre><code class="language-json">{
  "hash": "sha256:fc84b5febd328eccaa913807716887b3eb5ed08bc22cc6933a9ebf82766725e3",
  "layers": [
    {
      "hash": "sha256:fc84b5febd328eccaa913807716887b3eb5ed08bc22cc6933a9ebf82766725e3",
      "uri": "https://storage.example.com/blob/2f077db56abccc19f16f140f629ae98e904b4b7d563957a7fc319bd11b82ba36",
      "headers": {
        "property1": [
          "string"
        ],
        "property2": [
          "string"
        ]
      }
    }
  ]
}

</code></pre>
<p>Manifest</p>
<h3 id="properties-14"><a class="header" href="#properties-14">Properties</a></h3>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Required</th><th>Restrictions</th><th>Description</th></tr></thead><tbody>
<tr><td>hash</td><td><a href="reference/api.html#schemadigest">Digest</a></td><td>true</td><td>none</td><td>A digest string with prefixed algorithm. The format is described here: https://github.com/opencontainers/image-spec/blob/master/descriptor.md#digests<br>Digests are used throughout the API to identify Layers and Manifests.</td></tr>
<tr><td>layers</td><td>[<a href="reference/api.html#schemalayer">Layer</a>]</td><td>true</td><td>none</td><td>[A Layer within a Manifest and where Clair may retrieve it.]</td></tr>
</tbody></table>
</div><h2 id="tocS_Layer"><a class="header" href="#tocS_Layer">Layer</a></h2>
<!-- backwards compatibility -->
<a id="schemalayer"></a>
<a id="schema_Layer"></a>
<a id="tocSlayer"></a>
<a id="tocslayer"></a>
<pre><code class="language-json">{
  "hash": "sha256:fc84b5febd328eccaa913807716887b3eb5ed08bc22cc6933a9ebf82766725e3",
  "uri": "https://storage.example.com/blob/2f077db56abccc19f16f140f629ae98e904b4b7d563957a7fc319bd11b82ba36",
  "headers": {
    "property1": [
      "string"
    ],
    "property2": [
      "string"
    ]
  }
}

</code></pre>
<p>Layer</p>
<h3 id="properties-15"><a class="header" href="#properties-15">Properties</a></h3>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Required</th><th>Restrictions</th><th>Description</th></tr></thead><tbody>
<tr><td>hash</td><td><a href="reference/api.html#schemadigest">Digest</a></td><td>true</td><td>none</td><td>A digest string with prefixed algorithm. The format is described here: https://github.com/opencontainers/image-spec/blob/master/descriptor.md#digests<br>Digests are used throughout the API to identify Layers and Manifests.</td></tr>
<tr><td>uri</td><td>string</td><td>true</td><td>none</td><td>A URI describing where the layer may be found. Implementations MUST support http(s) schemes and MAY support additional schemes.</td></tr>
<tr><td>headers</td><td>object</td><td>true</td><td>none</td><td>map of arrays of header values keyed by header value. e.g. map[string][]string</td></tr>
<tr><td>» <strong>additionalProperties</strong></td><td>[string]</td><td>false</td><td>none</td><td>none</td></tr>
</tbody></table>
</div><h2 id="tocS_BulkDelete"><a class="header" href="#tocS_BulkDelete">BulkDelete</a></h2>
<!-- backwards compatibility -->
<a id="schemabulkdelete"></a>
<a id="schema_BulkDelete"></a>
<a id="tocSbulkdelete"></a>
<a id="tocsbulkdelete"></a>
<pre><code class="language-json">[
  "sha256:fc84b5febd328eccaa913807716887b3eb5ed08bc22cc6933a9ebf82766725e3"
]

</code></pre>
<p>BulkDelete</p>
<h3 id="properties-16"><a class="header" href="#properties-16">Properties</a></h3>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Required</th><th>Restrictions</th><th>Description</th></tr></thead><tbody>
<tr><td>BulkDelete</td><td>[<a href="reference/api.html#schemadigest">Digest</a>]</td><td>false</td><td>none</td><td>An array of Digests to be deleted.</td></tr>
</tbody></table>
</div><h2 id="tocS_Error"><a class="header" href="#tocS_Error">Error</a></h2>
<!-- backwards compatibility -->
<a id="schemaerror"></a>
<a id="schema_Error"></a>
<a id="tocSerror"></a>
<a id="tocserror"></a>
<pre><code class="language-json">{
  "code": "string",
  "message": "string"
}

</code></pre>
<p>Error</p>
<h3 id="properties-17"><a class="header" href="#properties-17">Properties</a></h3>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Required</th><th>Restrictions</th><th>Description</th></tr></thead><tbody>
<tr><td>code</td><td>string</td><td>false</td><td>none</td><td>a code for this particular error</td></tr>
<tr><td>message</td><td>string</td><td>false</td><td>none</td><td>a message with further detail</td></tr>
</tbody></table>
</div><h2 id="tocS_State"><a class="header" href="#tocS_State">State</a></h2>
<!-- backwards compatibility -->
<a id="schemastate"></a>
<a id="schema_State"></a>
<a id="tocSstate"></a>
<a id="tocsstate"></a>
<pre><code class="language-json">{
  "state": "aae368a064d7c5a433d0bf2c4f5554cc"
}

</code></pre>
<p>State</p>
<h3 id="properties-18"><a class="header" href="#properties-18">Properties</a></h3>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Required</th><th>Restrictions</th><th>Description</th></tr></thead><tbody>
<tr><td>state</td><td>string</td><td>true</td><td>none</td><td>an opaque identifier</td></tr>
</tbody></table>
</div><h2 id="tocS_Digest"><a class="header" href="#tocS_Digest">Digest</a></h2>
<!-- backwards compatibility -->
<a id="schemadigest"></a>
<a id="schema_Digest"></a>
<a id="tocSdigest"></a>
<a id="tocsdigest"></a>
<pre><code class="language-json">"sha256:fc84b5febd328eccaa913807716887b3eb5ed08bc22cc6933a9ebf82766725e3"

</code></pre>
<p>Digest</p>
<h3 id="properties-19"><a class="header" href="#properties-19">Properties</a></h3>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Required</th><th>Restrictions</th><th>Description</th></tr></thead><tbody>
<tr><td>Digest</td><td>string</td><td>false</td><td>none</td><td>A digest string with prefixed algorithm. The format is described here: https://github.com/opencontainers/image-spec/blob/master/descriptor.md#digests<br>Digests are used throughout the API to identify Layers and Manifests.</td></tr>
</tbody></table>
</div><div style="break-before: page; page-break-before: always;"></div><h1 id="clairctl"><a class="header" href="#clairctl">Clairctl</a></h1>
<p><code>clairctl</code> is a command line tool for working with Clair.
This CLI is capable of generating manifests from most public registries
(dockerhub, quay.io, Red Hat Container Catalog) and submitting them for
analysis to a running Clair.</p>
<p>Note that if the Clair instance has authentication configured, the value
provided to the <code>issuer</code> flag must be on the list accepted by the server.</p>
<pre><code>NAME:
   clairctl - interact with a clair API

USAGE:
   clairctl [global options] command [command options] [arguments...]

VERSION:
   0.1.0

DESCRIPTION:
   A command-line tool for clair v4.

COMMANDS:
   manifest         print a clair manifest for the named container
   report           request vulnerability reports for the named containers
   export-updaters  run updaters and export results
   import-updaters  import updates
   help, h          Shows a list of commands or help for one command

GLOBAL OPTIONS:
   -D                           print debugging logs (default: false)
   --config value, -c value     clair configuration file (default: "config.yaml") [$CLAIR_CONF]
   --issuer value, --iss value  jwt "issuer" to use when making authenticated requests (default: "clairctl")
   --help, -h                   show help (default: false)
   --version, -v                print the version (default: false)
</code></pre>
<pre><code>NAME:
   clairctl manifest - print a clair manifest for the named container

USAGE:
   clairctl manifest [arguments...]

DESCRIPTION:
   print a clair manifest for the named container
</code></pre>
<pre><code>NAME:
   clairctl report - request vulnerability reports for the named containers

USAGE:
   clairctl report [command options] container...

DESCRIPTION:
   Request and print a Clair vulnerability report for the named container(s).

OPTIONS:
   --host value           URL for the clairv4 v1 API. (default: "http://localhost:6060/") [$CLAIR_API]
   --out value, -o value  output format: text, json, xml (default: text)
</code></pre>
<pre><code>NAME:
   clairctl export-updaters - run updaters and export results

USAGE:
   clairctl export-updaters [command options] [out]

DESCRIPTION:
   Run configured exporters and export to a file.

   A configuration file is needed to run this command, see 'clairctl help'
   for how to specify one.

OPTIONS:
   --strict  Return non-zero exit when updaters report errors. (default: false)
</code></pre>
<pre><code>NAME:
   clairctl import-updaters - import updates

USAGE:
   clairctl import-updaters input...

DESCRIPTION:
   Import updates from files or HTTP URIs.

   A configuration file is needed to run this command, see 'clairctl help'
   for how to specify one.
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="config"><a class="header" href="#config">Config</a></h1>
<h2 id="cli-flags-and-environment-variables"><a class="header" href="#cli-flags-and-environment-variables">CLI Flags And Environment Variables</a></h2>
<p>Clair is configured by a structured yaml or JSON<sup class="footnote-reference"><a href="#1">1</a></sup> file and an optional directory of "merge" and "patch" documents<sup class="footnote-reference"><a href="#1">1</a></sup>.
Each Clair node needs to specify what mode it will run in and a path to a configuration file via CLI flags or environment variables.</p>
<p>For example:</p>
<pre><code class="language-shell">$ clair -conf ./path/to/config.yaml -mode indexer
$ clair -conf ./path/to/config.yaml -mode matcher
</code></pre>
<pre><code>-mode 
    (also specified by CLAIR_MODE env variable)
    One of the following strings
    Sets which mode the clair instances will run in
    
    "indexer": runs just the indexer node
    "matcher": runs just the matcher node
    "notifier": runs just the notifier node
    "combo": will run all services on the same node.
-conf
    (also specified by CLAIR_CONF env variable)
    A file system path to Clair's config file
</code></pre>
<p>The above example starts two Clair nodes using the same configuration.
One will only run the indexing facilities while the other will only run the matching facilities.</p>
<p>Environment variables respected by the Go standard library can be specified
if needed. Some notable examples:</p>
<ul>
<li><code>HTTP_PROXY</code></li>
<li><code>HTTPS_PROXY</code></li>
<li><code>SSL_CERT_DIR</code></li>
</ul>
<p>If running in "combo" mode you <strong>must</strong> supply the <code>indexer</code>, <code>matcher</code>,
and <code>notifier</code> configuration blocks in the configuration.</p>
<h2 id="configuration-dropins"><a class="header" href="#configuration-dropins">Configuration dropins</a></h2>
<p>Starting in Clair version <code>4.7.0</code>, dropin configuration files are supported.</p>
<p>Given a root configurtaion file of <code>/etc/clair/config.json</code>, all files matching the globs <code>/etc/clair/config.json.d/*.json</code> and <code>/etc/clair/config.json.d/*.json-patch</code> would be loaded in lexical order after the root configuration file.
Similarly, given <code>/etc/clair/config.yaml</code>, all files matching the globs <code>/etc/clair/config.yaml.d/*.yaml</code> and <code>/etc/clair/config.yaml.d/*.yaml-patch</code> would be loaded.
Only the extensions <code>yaml</code> and <code>json</code> are supported, and indicate yaml and JSON formatting, respectively.</p>
<p>The dropin files must have the same extension and format as the root file.
Dropins with the bare suffix are treated as <a href="reference/rfc7386">merge documents</a>.
Dropins with the <code>-patch</code> suffix are treated as <a href="reference/rfc6902">patch documents</a> and must contain a valid <a href="reference/rfc6902">RFC 6902</a> structure.
Yaml documents must be resolvable to the JSON subset.</p>
<p>Take care with the <a href="reference/rfc7386">merge</a> behavior around lists; a patch operation may be more suitable.
The <code>clairctl check-config</code> command can be used to ensure a merged configuration is what is intended.
In addition, placing <code>test</code> operations in a patch file that's evaluated last (such as <code>zz-validate.json-patch</code>) can be used to have Clair refuse to start if some configuration values are not what is intended.</p>
<p>The application defaults are applied <em>after</em> the configuration is loaded and as such, not reflected in the <code>clairctl check-config</code> command.
The output of that command is also not currently suitable to be used to "compile" a config to a single file.</p>
<h2 id="deprecations-and-changes"><a class="header" href="#deprecations-and-changes">Deprecations and Changes</a></h2>
<p>Starting in version <code>4.7.0</code>, unknown keys are disallowed.
Configurations that looked valid previously and loaded fine may now cause Clair to refuse to start.</p>
<p>In version <code>4.8.0</code>, using Jaeger for trace submission was deprecated.
Configurations that use Jaeger will print a warning.
In future versions, using the Jaeger format may cause an error.</p>
<h2 id="configuration-reference"><a class="header" href="#configuration-reference">Configuration Reference</a></h2>
<p>Please see the <a href="https://pkg.go.dev/github.com/quay/clair/config">go module documentation</a> for additional documentation on defaults and use.</p>
<pre><code>http_listen_addr: ""
introspection_addr: ""
log_level: ""
tls: {}
indexer:
    connstring: ""
    scanlock_retry: 0
    layer_scan_concurrency: 0
    migrations: false
    scanner: {}
    airgap: false
matcher:
    connstring: ""
    indexer_addr: ""
    migrations: false
    period: ""
    disable_updaters: false
    update_retention: 2
matchers:
    names: nil
    config: nil
updaters:
    sets: nil
    config: nil
notifier:
    connstring: ""
    migrations: false
    indexer_addr: ""
    matcher_addr: ""
    poll_interval: ""
    delivery_interval: ""
    disable_summary: false
    webhook: null
    amqp: null
    stomp: null
auth: 
  psk: nil
trace:
    name: ""
    probability: null
    jaeger:
        agent:
            endpoint: ""
        collector:
            endpoint: ""
            username: null
            password: null
        service_name: ""
        tags: nil
        buffer_max: 0
    otlp:
	  http: {}
      grpc: {}
metrics:
    name: ""
    prometheus:
        endpoint: null
</code></pre>
<p>Note: the above just lists every key for completeness. Copy-pasting the above as
a starting point for configuration will result in some options not having their
defaults set normally.</p>
<!---
The following are purposefully omitted. See comments in the config package for
more information.

# `$.tls.root_ca`
# `$.updaters.filter`
# `$.notifier.webhook.signed`
# `$.auth.keyserver`
# `$.auth.keyserver.api`
# `$.auth.keyserver.intraservice`
# `$.trace.otlp.http.client_tls`
# `$.trace.otlp.http.client_tls.root_ca`
# `$.trace.otlp.grpc.client_tls`
# `$.trace.otlp.grpc.client_tls.root_ca`
# `$.metrics.otlp.http.client_tls`
# `$.metrics.otlp.http.client_tls.root_ca`
# `$.metrics.otlp.grpc.client_tls`
# `$.metrics.otlp.grpc.client_tls.root_ca`
-->
<h3 id="http_listen_addr"><a class="header" href="#http_listen_addr"><code>$.http_listen_addr</code></a></h3>
<p>A string in <code>&lt;host&gt;:&lt;port&gt;</code> format where <code>&lt;host&gt;</code> can be an empty string.</p>
<p>This configures where the HTTP API is exposed.
See <code>/openapi/v1</code> for the API spec.</p>
<h3 id="introspection_addr"><a class="header" href="#introspection_addr"><code>$.introspection_addr</code></a></h3>
<p>A string in <code>&lt;host&gt;:&lt;port&gt;</code> format where <code>&lt;host&gt;</code> can be an empty string.</p>
<p>This configures where Clair's metrics and health endpoints are exposed.</p>
<h3 id="log_level"><a class="header" href="#log_level"><code>$.log_level</code></a></h3>
<p>Set the logging level.</p>
<p>One of the following strings:</p>
<ul>
<li>debug-color</li>
<li>debug</li>
<li>info</li>
<li>warn</li>
<li>error</li>
<li>fatal</li>
<li>panic</li>
</ul>
<h3 id="tls"><a class="header" href="#tls"><code>$.tls</code></a></h3>
<p>TLS is a map containing the config for serving the HTTP API over TLS (and
HTTP/2).</p>
<h4 id="tlscert"><a class="header" href="#tlscert"><code>$.tls.cert</code></a></h4>
<p>The TLS certificate to be used. Must be a full-chain certificate, as in nginx.</p>
<h4 id="tlskey"><a class="header" href="#tlskey"><code>$.tls.key</code></a></h4>
<p>A key file for the TLS certificate. Encryption is not supported on the key.</p>
<h3 id="indexer"><a class="header" href="#indexer"><code>$.indexer</code></a></h3>
<p>Indexer provides Clair Indexer node configuration.</p>
<h4 id="indexerairgap"><a class="header" href="#indexerairgap"><code>$.indexer.airgap</code></a></h4>
<p>Disables HTTP access to the Internet for indexers and fetchers.
Private IPv4 and IPv6 addresses are allowed.
Database connections are unaffected.</p>
<h4 id="indexerconnstring"><a class="header" href="#indexerconnstring"><code>$.indexer.connstring</code></a></h4>
<p>A Postgres connection string.</p>
<p>Accepts a format as a url (e.g.,
<code>postgres://pqgotest:password@localhost/pqgotest?sslmode=verify-full</code>)
or a libpq connection string (e.g.,
<code>user=pqgotest dbname=pqgotest sslmode=verify-full</code>).</p>
<h4 id="indexerindex_report_request_concurrency"><a class="header" href="#indexerindex_report_request_concurrency"><code>$.indexer.index_report_request_concurrency</code></a></h4>
<p>Integer.</p>
<p>Rate limits the number of index report creation requests.</p>
<p>Setting this to 0 will attempt to auto-size this value. Setting a negative value
means "unlimited." The auto-sizing is a multiple of the number of available
cores.</p>
<p>The API will return a 429 status code if concurrency is exceeded.</p>
<h4 id="indexerscanlock_retry"><a class="header" href="#indexerscanlock_retry"><code>$.indexer.scanlock_retry</code></a></h4>
<p>A positive integer representing seconds.</p>
<p>Concurrent Indexers lock on manifest scans to avoid clobbering.
This value tunes how often a waiting Indexer will poll for the lock.</p>
<!--TODO: Move to async operating mode -->
<h4 id="indexerlayer_scan_concurrency"><a class="header" href="#indexerlayer_scan_concurrency"><code>$.indexer.layer_scan_concurrency</code></a></h4>
<p>Positive integer limiting the number of concurrent layer scans.</p>
<p>Indexers will index a Manifest's layers concurrently.
This value tunes the number of layers an Indexer will scan in parallel.</p>
<h4 id="indexermigrations"><a class="header" href="#indexermigrations"><code>$.indexer.migrations</code></a></h4>
<p>A boolean value.</p>
<p>Whether Indexer nodes handle migrations to their database.</p>
<h4 id="indexerscanner"><a class="header" href="#indexerscanner"><code>$.indexer.scanner</code></a></h4>
<p>Indexer configurations.</p>
<p>Scanner allows for passing configuration options to layer scanners.
The scanner will have this configuration passed to it on construction if
designed to do so.</p>
<h4 id="indexerscannerdist"><a class="header" href="#indexerscannerdist"><code>$.indexer.scanner.dist</code></a></h4>
<p>A map with the name of a particular scanner and arbitrary yaml as a value.</p>
<h4 id="indexerscannerpackage"><a class="header" href="#indexerscannerpackage"><code>$.indexer.scanner.package</code></a></h4>
<p>A map with the name of a particular scanner and arbitrary yaml as a value.</p>
<h4 id="indexerscannerrepo"><a class="header" href="#indexerscannerrepo"><code>$.indexer.scanner.repo</code></a></h4>
<p>A map with the name of a particular scanner and arbitrary yaml as a value.</p>
<h3 id="matcher"><a class="header" href="#matcher"><code>$.matcher</code></a></h3>
<p>Matcher provides Clair matcher node configuration.</p>
<h4 id="matchercache_age"><a class="header" href="#matchercache_age"><code>$.matcher.cache_age</code></a></h4>
<p>Duration string.</p>
<p>Controls how long clients should be hinted to cache responses for.</p>
<h4 id="matcherconnstring"><a class="header" href="#matcherconnstring"><code>$.matcher.connstring</code></a></h4>
<p>A Postgres connection string.</p>
<p>Accepts a format as a url (e.g.,
<code>postgres://pqgotest:password@localhost/pqgotest?sslmode=verify-full</code>)
or a libpq connection string (e.g.,
<code>user=pqgotest dbname=pqgotest sslmode=verify-full</code>).</p>
<h4 id="matchermax_conn_pool"><a class="header" href="#matchermax_conn_pool"><code>$.matcher.max_conn_pool</code></a></h4>
<p>A positive integer limiting the database connection pool size.</p>
<p>Clair allows for a custom connection pool size.
This number will directly set how many active database
connections are allowed concurrently.</p>
<p>This parameter will be ignored in a future version.
Users should configure this through the connection string.</p>
<h4 id="matcherindexer_addr"><a class="header" href="#matcherindexer_addr"><code>$.matcher.indexer_addr</code></a></h4>
<p>A string in <code>&lt;host&gt;:&lt;port&gt;</code> format where <code>&lt;host&gt;</code> can be an empty string.</p>
<p>A Matcher contacts an Indexer to create a VulnerabilityReport.
The location of this Indexer is required.</p>
<h4 id="matchermigrations"><a class="header" href="#matchermigrations"><code>$.matcher.migrations</code></a></h4>
<p>A boolean value.</p>
<p>Whether Matcher nodes handle migrations to their databases.</p>
<h4 id="matcherperiod"><a class="header" href="#matcherperiod"><code>$.matcher.period</code></a></h4>
<p>A time.ParseDuration parseable string.</p>
<p>Determines how often updates for new security advisories will take place.</p>
<p>Defaults to 6 hours.</p>
<h4 id="matcherdisable_updaters"><a class="header" href="#matcherdisable_updaters"><code>$.matcher.disable_updaters</code></a></h4>
<p>A boolean value.</p>
<p>Whether to run background updates or not.</p>
<h4 id="matcherupdate_retention"><a class="header" href="#matcherupdate_retention"><code>$.matcher.update_retention</code></a></h4>
<p>An integer value limiting the number of update operations kept in the database.</p>
<p>Sets the number of update operations to retain between garbage collection
cycles. This should be set to a safe MAX value based on database size
constraints.</p>
<p>Defaults to 10.</p>
<p>If a value less than 0 is provided, GC is disabled. 2 is the minimum value to
ensure updates can be compared for notifications.</p>
<h3 id="matchers"><a class="header" href="#matchers"><code>$.matchers</code></a></h3>
<p>Matchers provides configuration for the in-tree Matchers and RemoteMatchers.</p>
<h4 id="matchersnames"><a class="header" href="#matchersnames"><code>$.matchers.names</code></a></h4>
<p>A list of string values informing the matcher factory about enabled matchers.</p>
<p>If the value is nil the default list of Matchers will run:</p>
<ul>
<li>alpine-matcher</li>
<li>aws-matcher</li>
<li>debian-matcher</li>
<li>gobin</li>
<li>java-maven</li>
<li>oracle</li>
<li>photon</li>
<li>python</li>
<li>rhel</li>
<li>rhel-container-matcher</li>
<li>suse</li>
<li>ubuntu-matcher</li>
</ul>
<p>If an empty list is provided zero matchers will run.</p>
<h4 id="matchersconfig"><a class="header" href="#matchersconfig"><code>$.matchers.config</code></a></h4>
<p>Provides configuration to specific matcher.</p>
<p>A map keyed by the name of the matcher containing a sub-object which
will be provided to the matchers factory constructor.</p>
<p>A hypothetical example:</p>
<pre><code>config:
  python:
    ignore_vulns:
      - CVE-XYZ
      - CVE-ABC
</code></pre>
<h3 id="updaters-1"><a class="header" href="#updaters-1"><code>$.updaters</code></a></h3>
<p>Updaters provides configuration for the Matcher's update manager.</p>
<h4 id="updaterssets"><a class="header" href="#updaterssets"><code>$.updaters.sets</code></a></h4>
<p>A list of string values informing the update manager which Updaters to run.</p>
<p>If the value is nil (or <code>null</code> in yaml) the default set of Updaters will run:</p>
<ul>
<li>alpine</li>
<li>aws</li>
<li>debian</li>
<li>oracle</li>
<li>osv</li>
<li>photon</li>
<li>rhcc</li>
<li>rhel</li>
<li>suse</li>
<li>ubuntu</li>
</ul>
<p>If an empty list is provided zero updaters will run.</p>
<h4 id="updatersconfig"><a class="header" href="#updatersconfig"><code>$.updaters.config</code></a></h4>
<p>Provides configuration to specific updater sets.</p>
<p>A map keyed by the name of the updater set name containing a sub-object
which will be provided to the updater set's constructor.</p>
<p>A hypothetical example:</p>
<pre><code>config:
  ubuntu:
    security_tracker_url: http://security.url
    ignore_distributions: 
      - cosmic
</code></pre>
<h3 id="notifier"><a class="header" href="#notifier"><code>$.notifier</code></a></h3>
<p>Notifier provides Clair notifier node configuration.</p>
<h4 id="notifierconnstring"><a class="header" href="#notifierconnstring"><code>$.notifier.connstring</code></a></h4>
<p>A Postgres connection string.</p>
<p>Accepts a format as a url (e.g.,
<code>postgres://pqgotest:password@localhost/pqgotest?sslmode=verify-full</code>)
or a libpq connection string (e.g.,
<code>user=pqgotest dbname=pqgotest sslmode=verify-full</code>).</p>
<h4 id="notifiermigrations"><a class="header" href="#notifiermigrations"><code>$.notifier.migrations</code></a></h4>
<p>A boolean value.</p>
<p>Whether Notifier nodes handle migrations to their database.</p>
<h4 id="notifierindexer_addr"><a class="header" href="#notifierindexer_addr"><code>$.notifier.indexer_addr</code></a></h4>
<p>A string in <code>&lt;host&gt;:&lt;port&gt;</code> format where <code>&lt;host&gt;</code> can be an empty string.</p>
<p>A Notifier contacts an Indexer to create obtain manifests affected by
vulnerabilities. The location of this Indexer is required.</p>
<h4 id="notifiermatcher_addr"><a class="header" href="#notifiermatcher_addr"><code>$.notifier.matcher_addr</code></a></h4>
<p>A string in <code>&lt;host&gt;:&lt;port&gt;</code> format where <code>&lt;host&gt;</code> can be an empty string.</p>
<p>A Notifier contacts a Matcher to list update operations and acquire diffs.
The location of this Indexer is required.</p>
<h4 id="notifierpoll_interval"><a class="header" href="#notifierpoll_interval"><code>$.notifier.poll_interval</code></a></h4>
<p>A time.ParseDuration parsable string.</p>
<p>The frequency at which the notifier will query at Matcher for Update Operations.</p>
<h4 id="notifierdelivery_interval"><a class="header" href="#notifierdelivery_interval"><code>$.notifier.delivery_interval</code></a></h4>
<p>A time.ParseDuration parsable string.</p>
<p>The frequency at which the notifier attempt delivery of created or previously
failed notifications.</p>
<h4 id="notifierdisable_summary"><a class="header" href="#notifierdisable_summary"><code>$.notifier.disable_summary</code></a></h4>
<p>A boolean.</p>
<p>Controls whether notifications should be summarized to one per manifest or not.</p>
<h4 id="notifierwebhook"><a class="header" href="#notifierwebhook"><code>$.notifier.webhook</code></a></h4>
<p>Configures the notifier for webhook delivery.</p>
<h4 id="notifierwebhooktarget"><a class="header" href="#notifierwebhooktarget"><code>$.notifier.webhook.target</code></a></h4>
<p>URL where the webhook will be delivered.</p>
<h4 id="notifierwebhookcallback"><a class="header" href="#notifierwebhookcallback"><code>$.notifier.webhook.callback</code></a></h4>
<p>The callback url where notifications can be retrieved.
The notification ID will be appended to this url.</p>
<p>This will typically be where the clair notifier is hosted.</p>
<h4 id="notifierwebhookheaders"><a class="header" href="#notifierwebhookheaders"><code>$.notifier.webhook.headers</code></a></h4>
<p>A map associating a header name to a list of values.</p>
<h4 id="notifieramqp"><a class="header" href="#notifieramqp"><code>$.notifier.amqp</code></a></h4>
<p>Configures the notifier for AMQP delivery.</p>
<p>Note: Clair does not declare any AMQP components on its own.  All attempts
to use an exchange or queue are passive only and will fail The broker
administrators should setup exchanges and queues ahead of time.</p>
<h4 id="notifieramqpdirect"><a class="header" href="#notifieramqpdirect"><code>$.notifier.amqp.direct</code></a></h4>
<p>A boolean value.</p>
<p>If true the Notifier will deliver individual notifications (not a callback)
to the configured AMQP broker.</p>
<h4 id="notifieramqprollup"><a class="header" href="#notifieramqprollup"><code>$.notifier.amqp.rollup</code></a></h4>
<p>Integer 0 or greater.</p>
<p>If <code>direct</code> is true this value will inform notifier how many notifications
to send in a single direct delivery.  For example, if <code>direct</code> is set to
<code>true</code> and <code>rollup</code> is set to <code>5</code>, the notifier will deliver no more then
5 notifications in a single json payload to the broker. Setting the value
to 0 will effectively set it to 1.</p>
<h4 id="notifieramqpexchange"><a class="header" href="#notifieramqpexchange"><code>$.notifier.amqp.exchange</code></a></h4>
<p>The AMQP Exchange to connect to.</p>
<h4 id="notifieramqpexchangename"><a class="header" href="#notifieramqpexchangename"><code>$.notifier.amqp.exchange.name</code></a></h4>
<p>string value</p>
<p>The name of the exchange to connect to.</p>
<h4 id="notifieramqpexchangetype"><a class="header" href="#notifieramqpexchangetype"><code>$.notifier.amqp.exchange.type</code></a></h4>
<p>string value</p>
<p>The type of the exchange. Typically:</p>
<ul>
<li>direct</li>
<li>fanout</li>
<li>topic</li>
<li>headers</li>
</ul>
<h4 id="notifieramqpexchangedurability"><a class="header" href="#notifieramqpexchangedurability"><code>$.notifier.amqp.exchange.durability</code></a></h4>
<p>bool value</p>
<p>Whether the configured queue is durable or not.</p>
<h4 id="notifieramqpexchangeauto_delete"><a class="header" href="#notifieramqpexchangeauto_delete"><code>$.notifier.amqp.exchange.auto_delete</code></a></h4>
<p>bool value</p>
<p>Whether the configured queue uses an auto_delete policy.</p>
<h4 id="notifieramqprouting_key"><a class="header" href="#notifieramqprouting_key"><code>$.notifier.amqp.routing_key</code></a></h4>
<p>string value</p>
<p>The name of the routing key each notification will be sent with.</p>
<h4 id="notifieramqpcallback"><a class="header" href="#notifieramqpcallback"><code>$.notifier.amqp.callback</code></a></h4>
<p>a URL string</p>
<p>If <code>direct</code> is <code>false</code>, this URL is provided in the notification callback sent
to the broker. This URL should point to Clair's notification API endpoint.</p>
<h4 id="notifieramqpuris"><a class="header" href="#notifieramqpuris"><code>$.notifier.amqp.uris</code></a></h4>
<p>list of URL strings</p>
<p>A list of one or more AMQP brokers to connect to, in priority order.</p>
<h4 id="notifieramqptls"><a class="header" href="#notifieramqptls"><code>$.notifier.amqp.tls</code></a></h4>
<p>Configures TLS connection to AMQP broker.</p>
<h4 id="notifieramqptlsroot_ca"><a class="header" href="#notifieramqptlsroot_ca"><code>$.notifier.amqp.tls.root_ca</code></a></h4>
<p>string value</p>
<p>The filesystem path where a root CA can be read.</p>
<h4 id="notifieramqptlscert"><a class="header" href="#notifieramqptlscert"><code>$.notifier.amqp.tls.cert</code></a></h4>
<p>string value</p>
<p>The filesystem path where a tls certificate can be read. Note that clair
also respects <code>SSL_CERT_DIR</code>, as documented for the Go <code>crypto/x509</code> package.</p>
<h4 id="notifieramqptlskey"><a class="header" href="#notifieramqptlskey"><code>$.notifier.amqp.tls.key</code></a></h4>
<p>string value</p>
<p>The filesystem path where a TLS private key can be read.</p>
<h4 id="notifierstomp"><a class="header" href="#notifierstomp"><code>$.notifier.stomp</code></a></h4>
<p>Configures the notifier for STOMP delivery.</p>
<h4 id="notifierstompdirect"><a class="header" href="#notifierstompdirect"><code>$.notifier.stomp.direct</code></a></h4>
<p>A boolean value.</p>
<p>If <code>true</code>, the Notifier will deliver individual notifications (not a
callback) to the configured STOMP broker.</p>
<h4 id="notifierstomprollup"><a class="header" href="#notifierstomprollup"><code>$.notifier.stomp.rollup</code></a></h4>
<p>Integer 0 or greater.</p>
<p>If <code>direct</code> is <code>true</code>, this value will limit the number of notifications
sent in a single direct delivery.  For example, if <code>direct</code> is set to
<code>true</code> and <code>rollup</code> is set to <code>5</code>, the notifier will deliver no more
then 5 notifications in a single json payload to the broker. Setting the value
to 0 will effectively set it to 1.</p>
<h4 id="notifierstompcallback"><a class="header" href="#notifierstompcallback"><code>$.notifier.stomp.callback</code></a></h4>
<p>a URL string</p>
<p>If <code>direct</code> is <code>false</code>, this URL is provided in the notification callback sent
to the broker. This URL should point to Clair's notification API endpoint.</p>
<h4 id="notifierstompdestination"><a class="header" href="#notifierstompdestination"><code>$.notifier.stomp.destination</code></a></h4>
<p>a string value</p>
<p>The STOMP destination to deliver notifications to.</p>
<h4 id="notifierstompuris"><a class="header" href="#notifierstompuris"><code>$.notifier.stomp.uris</code></a></h4>
<p>list of URL strings</p>
<p>A list of one or more STOMP brokers to connect to in priority order.</p>
<h4 id="notifierstomptls"><a class="header" href="#notifierstomptls"><code>$.notifier.stomp.tls</code></a></h4>
<p>Configures TLS connection to STOMP broker.</p>
<h4 id="notifierstomptlsroot_ca"><a class="header" href="#notifierstomptlsroot_ca"><code>$.notifier.stomp.tls.root_ca</code></a></h4>
<p>string value</p>
<p>The filesystem path where a root CA can be read.
Note that clair also respects <code>SSL_CERT_DIR</code>, as documented for the Go
<code>crypto/x509</code> package.</p>
<h4 id="notifierstomptlscert"><a class="header" href="#notifierstomptlscert"><code>$.notifier.stomp.tls.cert</code></a></h4>
<p>string value</p>
<p>The filesystem path where a tls certificate can be read.</p>
<h4 id="notifierstomptlskey"><a class="header" href="#notifierstomptlskey"><code>$.notifier.stomp.tls.key</code></a></h4>
<p>string value</p>
<p>The filesystem path where a tls private key can be read.</p>
<h4 id="notifierstompuser"><a class="header" href="#notifierstompuser"><code>$.notifier.stomp.user</code></a></h4>
<p>Configures login details for the STOMP broker.</p>
<h4 id="notifierstompuserlogin"><a class="header" href="#notifierstompuserlogin"><code>$.notifier.stomp.user.login</code></a></h4>
<p>string value</p>
<p>The STOMP login to connect with.</p>
<h4 id="notifierstompuserpasscode"><a class="header" href="#notifierstompuserpasscode"><code>$.notifier.stomp.user.passcode</code></a></h4>
<p>string value</p>
<p>The STOMP passcode to connect with.</p>
<h3 id="auth"><a class="header" href="#auth"><code>$.auth</code></a></h3>
<p>Defines ClairV4's external and intra-service JWT based authentication.</p>
<p>If multiple auth mechanisms are defined, Clair will pick one. Currently, there
are not multiple mechanisms.</p>
<h3 id="authpsk"><a class="header" href="#authpsk"><code>$.auth.psk</code></a></h3>
<p>Defines preshared key authentication.</p>
<h4 id="authpskkey"><a class="header" href="#authpskkey"><code>$.auth.psk.key</code></a></h4>
<p>a string value</p>
<p>A shared base64 encoded key distributed between all parties signing and
verifying JWTs.</p>
<h4 id="authpskiss"><a class="header" href="#authpskiss"><code>$.auth.psk.iss</code></a></h4>
<p>a list of string value</p>
<p>A list of JWT issuers to verify. An empty list will accept any issuer in a
JWT claim.</p>
<h3 id="trace"><a class="header" href="#trace"><code>$.trace</code></a></h3>
<p>Defines distributed tracing configuration based on OpenTelemetry.</p>
<h4 id="tracename"><a class="header" href="#tracename"><code>$.trace.name</code></a></h4>
<p>Which submission format to use, one of:</p>
<ul>
<li>jaeger</li>
<li>otlp</li>
<li>sentry</li>
</ul>
<h4 id="traceprobability"><a class="header" href="#traceprobability"><code>$.trace.probability</code></a></h4>
<p>a float value</p>
<p>The probability a trace will occur.</p>
<h3 id="tracejaeger"><a class="header" href="#tracejaeger"><code>$.trace.jaeger</code></a></h3>
<p>Defines values for Jaeger tracing.</p>
<p><em><strong>NOTE</strong></em>: Jaeger has deprecated using the <code>jaeger</code> protocol and encouraging users to migrate to OTLP,
which Jaeger can ingest natively.</p>
<h4 id="tracejaegeragent"><a class="header" href="#tracejaegeragent"><code>$.trace.jaeger.agent</code></a></h4>
<p>Defines values for configuring delivery to a Jaeger agent.</p>
<h4 id="tracejaegeragentendpoint"><a class="header" href="#tracejaegeragentendpoint"><code>$.trace.jaeger.agent.endpoint</code></a></h4>
<p>a string value</p>
<p>An address in <code>&lt;host&gt;:&lt;post&gt;</code> syntax where traces can be submitted.</p>
<h4 id="tracejaegercollector"><a class="header" href="#tracejaegercollector"><code>$.trace.jaeger.collector</code></a></h4>
<p>Defines values for configuring delivery to a Jaeger collector.</p>
<h4 id="tracejaegercollectorendpoint"><a class="header" href="#tracejaegercollectorendpoint"><code>$.trace.jaeger.collector.endpoint</code></a></h4>
<p>a string value</p>
<p>An address in <code>&lt;host&gt;:&lt;post&gt;</code> syntax where traces can be submitted.</p>
<h4 id="tracejaegercollectorusername"><a class="header" href="#tracejaegercollectorusername"><code>$.trace.jaeger.collector.username</code></a></h4>
<p>a string value</p>
<h4 id="tracejaegercollectorpassword"><a class="header" href="#tracejaegercollectorpassword"><code>$.trace.jaeger.collector.password</code></a></h4>
<p>a string value</p>
<h4 id="tracejaegerservice_name"><a class="header" href="#tracejaegerservice_name"><code>$.trace.jaeger.service_name</code></a></h4>
<p>a string value</p>
<h4 id="tracejaegertags"><a class="header" href="#tracejaegertags"><code>$.trace.jaeger.tags</code></a></h4>
<p>a mapping of a string to a string</p>
<h4 id="tracejaegerbuffer_max"><a class="header" href="#tracejaegerbuffer_max"><code>$.trace.jaeger.buffer_max</code></a></h4>
<p>an integer value</p>
<h3 id="traceotlp"><a class="header" href="#traceotlp"><code>$.trace.otlp</code></a></h3>
<p>Configuration for OTLP traces.</p>
<p>Only one of the <code>http</code> or <code>grpc</code> keys should be provided.</p>
<h4 id="traceotlphttp"><a class="header" href="#traceotlphttp"><code>$.trace.otlp.http</code></a></h4>
<p>Configuration for OTLP traces submitted by HTTP.</p>
<h5 id="traceotlphttpurl_path"><a class="header" href="#traceotlphttpurl_path"><code>$.trace.otlp.http.url_path</code></a></h5>
<p>Request path to use for submissions.
Defaults to <code>/v1/traces</code>.</p>
<h5 id="traceotlphttpcompression"><a class="header" href="#traceotlphttpcompression"><code>$.trace.otlp.http.compression</code></a></h5>
<p>Compression for payloads.
One of:</p>
<ul>
<li>gzip</li>
<li>none</li>
</ul>
<h5 id="traceotlphttpendpoint"><a class="header" href="#traceotlphttpendpoint"><code>$.trace.otlp.http.endpoint</code></a></h5>
<p><code>Host:port</code> for submission. Defaults to <code>localhost:4318</code>.</p>
<h5 id="traceotlphttpheaders"><a class="header" href="#traceotlphttpheaders"><code>$.trace.otlp.http.headers</code></a></h5>
<p>Key-value pairs of additional headers for submissions.</p>
<h5 id="traceotlphttpinsecure"><a class="header" href="#traceotlphttpinsecure"><code>$.trace.otlp.http.insecure</code></a></h5>
<p>Use HTTP instead of HTTPS.</p>
<h5 id="traceotlphttptimeout"><a class="header" href="#traceotlphttptimeout"><code>$.trace.otlp.http.timeout</code></a></h5>
<p>Maximum of of time for a trace submission.</p>
<h5 id="traceotlphttpclient_tlscert"><a class="header" href="#traceotlphttpclient_tlscert"><code>$.trace.otlp.http.client_tls.cert</code></a></h5>
<p>Client certificate for connection.</p>
<h5 id="traceotlphttpclient_tlskey"><a class="header" href="#traceotlphttpclient_tlskey"><code>$.trace.otlp.http.client_tls.key</code></a></h5>
<p>Key for the certificate specified in <code>cert</code>.</p>
<h4 id="traceotlpgrpc"><a class="header" href="#traceotlpgrpc"><code>$.trace.otlp.grpc</code></a></h4>
<p>Configuration for OTLP traces submitted by gRPC.</p>
<h5 id="traceotlpgrpcreconnect"><a class="header" href="#traceotlpgrpcreconnect"><code>$.trace.otlp.grpc.reconnect</code></a></h5>
<p>Sets the minimum time between connection attempts.</p>
<h5 id="traceotlpgrpcservice_config"><a class="header" href="#traceotlpgrpcservice_config"><code>$.trace.otlp.grpc.service_config</code></a></h5>
<p>A string containing a JSON-format gRPC service config.</p>
<h5 id="traceotlpgrpccompression"><a class="header" href="#traceotlpgrpccompression"><code>$.trace.otlp.grpc.compression</code></a></h5>
<p>Compression for payloads.
One of:</p>
<ul>
<li>gzip</li>
<li>none</li>
</ul>
<h5 id="traceotlpgrpcendpoint"><a class="header" href="#traceotlpgrpcendpoint"><code>$.trace.otlp.grpc.endpoint</code></a></h5>
<p><code>Host:port</code> for submission. Defaults to <code>localhost:4317</code>.</p>
<h5 id="traceotlpgrpcheaders"><a class="header" href="#traceotlpgrpcheaders"><code>$.trace.otlp.grpc.headers</code></a></h5>
<p>Key-value pairs of additional headers for submissions.</p>
<h5 id="traceotlpgrpcinsecure"><a class="header" href="#traceotlpgrpcinsecure"><code>$.trace.otlp.grpc.insecure</code></a></h5>
<p>Do not verify the server certificate.</p>
<h5 id="traceotlpgrpctimeout"><a class="header" href="#traceotlpgrpctimeout"><code>$.trace.otlp.grpc.timeout</code></a></h5>
<p>Maximum of of time for a trace submission.</p>
<h5 id="traceotlpgrpcclient_tlscert"><a class="header" href="#traceotlpgrpcclient_tlscert"><code>$.trace.otlp.grpc.client_tls.cert</code></a></h5>
<p>Client certificate for connection.</p>
<h5 id="traceotlpgrpcclient_tlskey"><a class="header" href="#traceotlpgrpcclient_tlskey"><code>$.trace.otlp.grpc.client_tls.key</code></a></h5>
<p>Key for the certificate specified in <code>cert</code>.</p>
<h3 id="tracesentry"><a class="header" href="#tracesentry"><code>$.trace.sentry</code></a></h3>
<p>Configuration for submitting traces to Sentry.</p>
<p>This is done via OpenTelemetry instrumentation, so may not provide identical
results compared to other tracing backends or native Sentry instrumentation.</p>
<p>There's no integration for error submission.
This means that alternative implementations of the Sentry API that do not support submitting traces (such as <a href="https://glitchtip.com/">GlitchTip</a>) are not usable.</p>
<h4 id="tracesentrydsn"><a class="header" href="#tracesentrydsn"><code>$.trace.sentry.dsn</code></a></h4>
<p>Sentry DSN to use.
See also <a href="https://pkg.go.dev/github.com/getsentry/sentry-go#ClientOptions"><code>sentry-go.ClientOptions</code></a>.</p>
<h4 id="tracesentryenvironment"><a class="header" href="#tracesentryenvironment"><code>$.trace.sentry.environment</code></a></h4>
<p>Sentry environment to use.
See also <a href="https://pkg.go.dev/github.com/getsentry/sentry-go#ClientOptions"><code>sentry-go.ClientOptions</code></a>.</p>
<h3 id="metrics"><a class="header" href="#metrics"><code>$.metrics</code></a></h3>
<p>Defines distributed tracing configuration based on OpenTelemetry.</p>
<h4 id="metricsname"><a class="header" href="#metricsname"><code>$.metrics.name</code></a></h4>
<p>a string value</p>
<h3 id="metricsprometheus"><a class="header" href="#metricsprometheus"><code>$.metrics.prometheus</code></a></h3>
<p>Configuration for a prometheus metrics exporter.</p>
<h4 id="metricsprometheusendpoint"><a class="header" href="#metricsprometheusendpoint"><code>$.metrics.prometheus.endpoint</code></a></h4>
<p>a string value</p>
<p>Defines the path where metrics will be served.</p>
<h3 id="metricsotlp"><a class="header" href="#metricsotlp"><code>$.metrics.otlp</code></a></h3>
<p>Configuration for OTLP metrics.</p>
<p>Only one of the <code>http</code> or <code>grpc</code> keys should be provided.</p>
<h4 id="metricsotlphttp"><a class="header" href="#metricsotlphttp"><code>$.metrics.otlp.http</code></a></h4>
<p>Configuration for OTLP metrics submitted by HTTP.</p>
<h5 id="metricsotlphttpurl_path"><a class="header" href="#metricsotlphttpurl_path"><code>$.metrics.otlp.http.url_path</code></a></h5>
<p>Request path to use for submissions.
Defaults to <code>/v1/metrics</code>.</p>
<h5 id="metricsotlphttpcompression"><a class="header" href="#metricsotlphttpcompression"><code>$.metrics.otlp.http.compression</code></a></h5>
<p>Compression for payloads.
One of:</p>
<ul>
<li>gzip</li>
<li>none</li>
</ul>
<h5 id="metricsotlphttpendpoint"><a class="header" href="#metricsotlphttpendpoint"><code>$.metrics.otlp.http.endpoint</code></a></h5>
<p><code>Host:port</code> for submission. Defaults to <code>localhost:4318</code>.</p>
<h5 id="metricsotlphttpheaders"><a class="header" href="#metricsotlphttpheaders"><code>$.metrics.otlp.http.headers</code></a></h5>
<p>Key-value pairs of additional headers for submissions.</p>
<h5 id="metricsotlphttpinsecure"><a class="header" href="#metricsotlphttpinsecure"><code>$.metrics.otlp.http.insecure</code></a></h5>
<p>Use HTTP instead of HTTPS.</p>
<h5 id="metricsotlphttptimeout"><a class="header" href="#metricsotlphttptimeout"><code>$.metrics.otlp.http.timeout</code></a></h5>
<p>Maximum of of time for a metrics submission.</p>
<h5 id="metricsotlphttpclient_tlscert"><a class="header" href="#metricsotlphttpclient_tlscert"><code>$.metrics.otlp.http.client_tls.cert</code></a></h5>
<p>Client certificate for connection.</p>
<h5 id="metricsotlphttpclient_tlskey"><a class="header" href="#metricsotlphttpclient_tlskey"><code>$.metrics.otlp.http.client_tls.key</code></a></h5>
<p>Key for the certificate specified in <code>cert</code>.</p>
<h4 id="metricsotlpgrpc"><a class="header" href="#metricsotlpgrpc"><code>$.metrics.otlp.grpc</code></a></h4>
<p>Configuration for OTLP metrics submitted by gRPC.</p>
<h5 id="metricsotlpgrpcreconnect"><a class="header" href="#metricsotlpgrpcreconnect"><code>$.metrics.otlp.grpc.reconnect</code></a></h5>
<p>Sets the minimum time between connection attempts.</p>
<h5 id="metricsotlpgrpcservice_config"><a class="header" href="#metricsotlpgrpcservice_config"><code>$.metrics.otlp.grpc.service_config</code></a></h5>
<p>A string containing a JSON-format gRPC service config.</p>
<h5 id="metricsotlpgrpccompression"><a class="header" href="#metricsotlpgrpccompression"><code>$.metrics.otlp.grpc.compression</code></a></h5>
<p>Compression for payloads.
One of:</p>
<ul>
<li>gzip</li>
<li>none</li>
</ul>
<h5 id="metricsotlpgrpcendpoint"><a class="header" href="#metricsotlpgrpcendpoint"><code>$.metrics.otlp.grpc.endpoint</code></a></h5>
<p><code>Host:port</code> for submission. Defaults to <code>localhost:4318</code>.</p>
<h5 id="metricsotlpgrpcheaders"><a class="header" href="#metricsotlpgrpcheaders"><code>$.metrics.otlp.grpc.headers</code></a></h5>
<p>Key-value pairs of additional headers for submissions.</p>
<h5 id="metricsotlpgrpcinsecure"><a class="header" href="#metricsotlpgrpcinsecure"><code>$.metrics.otlp.grpc.insecure</code></a></h5>
<p>Use HTTP instead of HTTPS.</p>
<h5 id="metricsotlpgrpctimeout"><a class="header" href="#metricsotlpgrpctimeout"><code>$.metrics.otlp.grpc.timeout</code></a></h5>
<p>Maximum of of time for a metrics submission.</p>
<h5 id="metricsotlpgrpcclient_tlscert"><a class="header" href="#metricsotlpgrpcclient_tlscert"><code>$.metrics.otlp.grpc.client_tls.cert</code></a></h5>
<p>Client certificate for connection.</p>
<h5 id="metricsotlpgrpcclient_tlskey"><a class="header" href="#metricsotlpgrpcclient_tlskey"><code>$.metrics.otlp.grpc.client_tls.key</code></a></h5>
<p>Key for the certificate specified in <code>cert</code>.</p>
<hr />
<div class="footnote-definition" id="1"><sup class="footnote-definition-label">1</sup>
<p>Support added in version <code>4.7.0</code>.</p>
</div>
<div style="break-before: page; page-break-before: always;"></div><h1 id="indexer-1"><a class="header" href="#indexer-1">Indexer</a></h1>
<p>When Clair is running in Indexer mode, it is responsible for receiving Manifests and generating IndexReports. An IndexReport is an intermediate representation of a manifest's content and is used to discover vulnerabilities.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="matcher-1"><a class="header" href="#matcher-1">Matcher</a></h1>
<p>When Clair is running in Matcher mode it is responsible for receiving IndexReports and generating VulnerabilityReports. A VulnerabilityReport describes the contents of a manifest and any vulnerabilities affecting it.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="notifier-1"><a class="header" href="#notifier-1">Notifier</a></h1>
<p>When Clair is running in Notifier mode, it is responsible for generating notifications when new vulnerabilities affecting a previously indexed manifest enters the system. The notifier will send notifications via the configured mechanisms.</p>
<div style="break-before: page; page-break-before: always;"></div><p>Clair exports <a href="reference/./config.html#metrics">metrics</a> on the <a href="reference/./config.html#introspection_addr">introspection
port</a> in the Prometheus format.</p>
<p>The exact metrics exposed are not considered API (and so are subject to change
between releases) but should be well described. An up-to-date grafana dashboard
example is in <code>contrib/openshift/grafana</code>.</p>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->


                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">

            </nav>

        </div>




        <script>
            window.playground_copyable = true;
        </script>


        <script src="elasticlunr.min.js"></script>
        <script src="mark.min.js"></script>
        <script src="searcher.js"></script>

        <script src="clipboard.min.js"></script>
        <script src="highlight.js"></script>
        <script src="book.js"></script>

        <!-- Custom JS scripts -->

        <script>
        window.addEventListener('load', function() {
            window.setTimeout(window.print, 100);
        });
        </script>

    </div>
    </body>
</html>
